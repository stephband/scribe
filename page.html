<!DOCTYPE html>
<html lang="en">
<head>
    <!-- This document is a basic web page set up as a music chart -->
    <title>My Tune</title>

    <meta charset="utf-8" />
    <meta name="author" content="" />
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width" />

    <!--script type="importmap">{
        "imports": {
            "dom/":      "https://cdn.jsdelivr.net/gh/stephband/dom@1.4.1/modules/",
            "fn/":       "https://cdn.jsdelivr.net/gh/stephband/fn@1.5.x/modules/",
            "bolt/":     "https://cdn.jsdelivr.net/gh/stephband/bolt-2@1.0.1/",
            "midi/":     "https://cdn.jsdelivr.net/gh/stephband/midi@1.1.1/modules/",
            "sequence/": "https://cdn.jsdelivr.net/gh/soundio/sequence@0.1.12/modules/"
        },

        "lock": false
    }</script-->

    <script type="importmap">{
        "imports": {
            "dom/":      "/dom/modules/",
            "fn/":       "/fn/modules/",
            "bolt/":     "/bolt/",
            "midi/":     "/midi/modules/",
            "sequence/": "/sequence/modules/"
        }
    }</script>

    <!-- CSS Style rules -->
    <style>
        @import 'https://cdn.jsdelivr.net/gh/stephband/bolt-2@1.x/classes/atoms.css';
        @import './module.css';

        @import './editor/note.css';
        @import './editor/head.css';
        @import './editor/zone.css';
        @import './editor/selected.css';

        * {
            box-sizing: border-box;
        }

        html {
            height: 100%;
        }

        body {
            font-family: system-ui, sans-serif;
            margin: 0;
            padding: 1em 1.5em 0.5em;
            min-height: 100%;
            display: flex;
            flex-direction: column;

            --selection-fg: oklch(0.64 0.15 203.61);
            --zone-duration: 0.5;
        }

        body > footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 2;
        }

        header {
            font-family: JazzText, cursive;
            display: grid;
            grid-template-columns: [part] auto [title] 1fr [credits] auto;
            align-items: last baseline;
        }

        header > * {
            margin: 0;
            grid-row: 1;
        }

        header > .title {
            font-size: 3em;
            grid-column: title;
            justify-self: center;
            text-align: center;
        }

        header > .part {
            grid-column: part;
            justify-self: start;
            text-align: left;
        }

        header > .credit {
            grid-column: credit;
            justify-self: end;
            text-align: right;
        }

        footer {
            font-size: 0.625em;
            margin-top: auto;
            padding-bottom: 0.5em;
            background-color: white;
        }

        a {
            color: oklch(0.6 0.27 1.54);
            text-decoration: none;
        }

        /* For a more classic look... */
        /*@import 'https://cdn.jsdelivr.net/gh/stephband/scribe@0.4.x/build/fonts/bravura.css';

        header {
          font-family: BravuraText, serif;
        }

        scribe-music {
          font-family: Bravura, BravuraText;
        }*/
    </style>

    <script type="module">
        import Data     from 'fn/data.js';
        import Signal   from 'fn/signal.js';
        import Sequence from 'sequence/sequence.js';
        import create   from 'dom/create.js';
        import pointer  from './editor/pointer.js';
        import keyboard from './editor/keys.js';
        import { renderElements, renderStyle, renderDOM } from './modules/render.js';
        import data from './data/so-what.json' with { type: 'json' };

        const root     = document.querySelector('.scribe');
        const sequence = Data.of(Sequence.from(data));

        Signal.frame(() => {
            const elements = renderElements(
                // Events from data
                sequence,
                // Excludes is an array
                [],
                // Clef is a string
                'treble',
                // Key name
                '',
                // Create an initial [0, "meter", ...] event
                ''
            );

            const y = sequence.events.length;

            root.innerHTML = '';
            root.append.apply(root, elements);
            root.setAttribute('style', renderStyle(root));
            renderDOM(root);

            root.querySelectorAll('.bar').forEach((bar) => {
                bar.append(
                    create('div', { class: 'zone', tabindex: 0, data: { index: 0 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 1 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 2 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 3 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 4 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 5 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 6 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 7 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 8 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 9 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 10 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 11 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 12 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 13 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 14 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 15 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 16 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 17 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 18 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 19 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 20 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 21 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 22 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 23 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 24 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 25 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 26 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 27 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 28 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 29 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 30 } }),
                    create('div', { class: 'zone', tabindex: 0, data: { index: 31 } })
                );
            });
        });

        const state = {
            sequence: sequence,
            // Zone and cursos duration
            duration: 0.5
        };

        keyboard(root, state);
        pointer(root, state);
    </script>
</head>
<body data-zone="0.5">
    <header>
        <h1 class="title">My Tune</h1>
        <p class="part">Piano</p>
        <p class="credit"><span class="@1-shown">Composed by </span>My Name</p>
    </header>

    <main class="scribe scribe-regular"></main>

    <footer>
        <div class="keyboard">
            <h4 class="font-08 grid-label">Grid</h4>
            <h4 class="font-08 octave-label">Octave</h4>

            <kbd class="kbd-1"></kbd>
            <kbd title="1"><span class="glyph" style="font-family: Jazz, JazzText;">&#xE1D6;</span></kbd>
            <kbd title="2"><span class="glyph" style="font-family: Jazz, JazzText;">&#xE1D8;</span></kbd>
            <kbd title="3"><span class="glyph" style="font-family: Jazz, JazzText; font-size: 1.6667em;">&#xE883;</span><span class="glyph" style="font-family: Jazz, JazzText;">&#xE1D8;</span></kbd>
            <kbd title="4"><span class="glyph" style="font-family: Jazz, JazzText;">&#xE1DA;</span></kbd>
            <kbd title="5"><span class="glyph" style="font-family: Jazz, JazzText; font-size: 1.6667em;">&#xE885;</span><span class="glyph" style="font-family: Jazz, JazzText;">&#xE1DA;</span></kbd>
            <kbd title="6"><span class="glyph" style="font-family: Jazz, JazzText; font-size: 1.6667em;">&#xE883;</span><span class="glyph" style="font-family: Jazz, JazzText;">&#xE1DA;</span></kbd>
            <kbd title="7"><span class="glyph" style="font-family: Jazz, JazzText; font-size: 1.6667em;">&#xE887;</span><span class="glyph" style="font-family: Jazz, JazzText;">&#xE1DA;</span></kbd>
            <kbd title="8"><span class="glyph" style="font-family: Jazz, JazzText;">&#xE1DC;</span></kbd>
            <kbd title="9"><span class="glyph" style="font-family: Jazz, JazzText; font-size: 1.6667em;">&#xE889;</span><span class="glyph" style="font-family: Jazz, JazzText;">&#xE1DC;</span></kbd>
            <kbd></kbd>
            <kbd></kbd>
            <kbd></kbd>
            <kbd class="backspace-kbd">⌫</kbd>

            <kbd class="tab-kbd">⇥</kbd>
            <kbd></kbd>
            <kbd></kbd>
            <kbd></kbd>
            <kbd></kbd>
            <kbd></kbd>
            <kbd></kbd>
            <kbd></kbd>
            <kbd></kbd>
            <kbd></kbd>
            <kbd></kbd>
            <kbd></kbd>
            <kbd></kbd>
            <kbd class="enter-kbd" style="border-bottom-right-radius: 0;"></kbd>

            <kbd class="lock-kbd">⇪</kbd>
            <kbd title="" class="dark-kbd" data-note="56">A&#xED60;</kbd>
            <kbd title="" class="dark-kbd" data-note="58">B&#xED60;</kbd>
            <kbd></kbd>
            <kbd title="" class="dark-kbd" data-note="61">C&#xED62;</kbd>
            <kbd title="" class="dark-kbd" data-note="63">E&#xED60;</kbd>
            <kbd></kbd>
            <kbd title="" class="dark-kbd" data-note="66">F&#xED62;</kbd>
            <kbd title="" class="dark-kbd" data-note="68">A&#xED60;</kbd>
            <kbd title="" class="dark-kbd" data-note="70">B&#xED60;</kbd>
            <kbd></kbd>
            <kbd title="">-</kbd>
            <kbd title="">+</kbd>
            <kbd style="margin-top: -2px; height: calc(100% + 2px); border-top-left-radius: 0; border-top-right-radius: 0;">↵</kbd>

            <kbd class="l-shift-kbd shift-kbd">⇧</kbd>
            <kbd title="`" class="light-kbd" data-note="55">G</kbd>
            <kbd title="z" class="light-kbd" data-note="57">A</kbd>
            <kbd title="x" class="light-kbd" data-note="59">B</kbd>
            <kbd title="c" class="light-kbd" data-note="60">C<small>4</small></kbd>
            <kbd title="v" class="light-kbd" data-note="62">D</kbd>
            <kbd title="b" class="light-kbd" data-note="64">E</kbd>
            <kbd title="n" class="light-kbd" data-note="65">F</kbd>
            <kbd title="m" class="light-kbd" data-note="67">G</kbd>
            <kbd title="," class="light-kbd" data-note="69">A</kbd>
            <kbd title="." class="light-kbd" data-note="71">B</kbd>
            <kbd title="/" class="light-kbd" data-note="72">C<small>5</small></kbd>
            <kbd class="r-shift-kbd shift-kbd">⇧</kbd>

            <kbd></kbd>
            <kbd class="ctrl-kbd">^</kbd>
            <kbd class="alt-kbd">⌥</kbd>
            <kbd class="meta-kbd">⌘</kbd>
            <kbd class="space-kbd"></kbd>
            <kbd class="meta-kbd">⌘</kbd>
            <kbd class="alt-kbd">⌥</kbd>
            <kbd class="left-kbd">◂</kbd>
            <kbd class="up-kbd">▴</kbd>
            <kbd class="down-kbd">▾</kbd>
            <kbd class="right-kbd">▸</kbd>
        </div>
        <!--p>&copy;2025 My Name. <a href="https://stephen.band/scribe/">Scribe</a> by Stephen Band.</p-->
    </footer>
</body>
</html>

/* Scribe 
   0.4.5
   By Stephen */

var nr=Object.defineProperty;var or=(e,t)=>{for(var n in t)nr(e,n,{get:t[n],enumerable:!0})};var k,tt;function rr(e,t){let n=-1;for(;e[++n]&&e[n]!==t;);for(;e[n++];)e[n-1]=e[n]}function Be(e){let t=0;for(;e[--t];)e[t].stop&&e[t].stop(),e[t]=void 0}function yt(e,t){let n=0;for(;t[--n]&&t[n]!==e;);for(t[n]=e,n=-1;e[++n]&&e[n]!==t;);e[n]=t}function ut(e){let t=-1,n;for(;n=e[++t];)e[t]=void 0,n.invalidate(e)}function Re(e,t){let n=0;for(;e[--n];)if(e[n]===t)return!0}var v=class e{static isSignal(t){return t instanceof e}static of(t){return new ve(t)}static from(t,n){if(t.then){let o=e.of();return t.then(r=>o.value=r),o}return t.pipe?t.pipe(new De):new Lt(t,n)}static compute(t,n){return new Lt(t,n)}static fromProperty(t,n){return new Se(t,n)}static frame(t){return new Ht(t)}static tick(t){return new $t(t)}static temporal(t,n){return new Ce(t,n)}static evaluate(t,n,o=t){let r=k;k=t,r||(tt=!1);let i=n.apply(o);return k=r,i}static get hasInvalidDependency(){return tt}static get evaluating(){return k}constructor(t){t&&(this.name=t)}valueOf(){return this.value}toString(){return this.value+""}toJSON(){return this.value}},ve=class extends v{#t;constructor(t){super(),this.#t=t}get value(){return k&&yt(this,k),this.#t}set value(t){this.#t!==t&&(this.#t=t,ut(this))}},De=class extends v{#t;constructor(t){super(),this.#t=t}get value(){return k&&yt(this,k),this.#t}push(t){this.#t!==t&&(this.#t=t,ut(this))}},Se=class extends v{#t;#e;constructor(t,n){super(t),this.object=n}evaluate(){return this.object[this.name]}get value(){return k&&yt(this,k),this.#t?this.#e:(this.#e=v.evaluate(this,this.evaluate,this),tt||(this.#t=!0),this.#e)}set value(t){if(this.#e===t)return;let{object:n,name:o}=this;n[o]=t,t=n[o],this.#e!==t&&(this.#e=t,ut(this))}invalidate(t){this.#t&&(t&&!Re(this,t)||(this.#t=!1,Be(this),ut(this)))}},Lt=class extends v{#t;#e;#n;#o;constructor(t,n){super(),this.#t=t,this.#e=n}get value(){return k&&yt(this,k),this.#n?this.#o:(this.#o=v.evaluate(this,this.#t,this.#e),tt||(this.#n=!0),this.#o)}invalidate(t){this.#n&&(t&&!Re(this,t)||(this.#n=!1,Be(this),ut(this)))}},Ce=class extends v{#t=0;constructor(t,n){super(t),this.object=n}getTime(){return window.performance.now()}evaluate(){return this.object[this.name]}get value(){return v.evaluating&&(yt(this,k),this.getTime()<this.#t&&(tt=!0)),this.evaluate()}set value(t){console.warn("Dont really want to be setting value of TimedSignal"),console.trace(),this.object[this.name]!==t&&(this.object[this.name]=t,invalidateUntil(this.getTime()))}invalidateUntil(t){let o=this.getTime()>=this.#t;this.#t=t,o&&ut(this)}},qt=class extends v{constructor(t){if(super(),k){let n=0;for(;k[--n]&&k[n]!==this;);k[n]=this}t&&(this.evaluate=t,(v.evaluate(this,this.evaluate)||tt)&&this.cue())}invalidate(t){this.constructor.observers.indexOf(this)===-1&&(t&&!Re(this,t)||(Be(this),this.cue()))}stop(){let t=0,n;for(;n=this[--t];){let i=-1;this[t]=void 0,n.stop?n.stop():rr(n,this)}let o=this.constructor.observers,r=o.indexOf(this);if(r!==-1){if(o===Ae)throw new Error("Attempt to remove observer while observers is rendering");o.splice(r,1)}return this}valueOf(){return this}toString(){return"[object Signal]"}toJSON(){}},Ae;function Mn(e){let t=-1,n;for(Ae=e;n=e[++t];)!v.evaluate(n,n.evaluate)&&!tt&&e.splice(t--,1);return Ae=void 0,e}var Ln=Promise.resolve();function qn(){Mn($t.observers).length&&Ln.then(qn)}var $t=class extends qt{static observers=[];cue(){let t=this.constructor.observers;t.length||Ln.then(qn),t.push(this)}};function $n(){Mn(Ht.observers).length&&requestAnimationFrame($n)}var Ht=class extends qt{static observers=[];cue(){let t=this.constructor.observers;t.length||window.requestAnimationFrame($n),t.push(this)}};function ir(){return{x:0,y:0,left:0,top:0,right:window.innerWidth,bottom:window.innerHeight,width:window.innerWidth,height:window.innerHeight}}function Fe(e){return e===window?ir():e.getClientRects()[0]||e.getBoundingClientRect()}function $(e){return e}function B(e,t){return function(){let o=e.apply(this,arguments),r=t[o]||t.default;if(!r)throw new Error('overload() no function defined for key "'+o+'"');return r.apply(this,arguments)}}function lt(e){var t=new Map;return function(o){if(t.has(o))return t.get(o);var r=e(o);return t.set(o,r),r}}var sr=Array.prototype;function ar(e,t){return typeof e=="function"?e.apply(null,t):e}function Hn(e,t,n){n=n||e.length;var o=n===1?t?e:lt(e):lt(function(r){return Hn(function(){var i=[r];return i.push.apply(i,arguments),e.apply(null,i)},t,n-1)});return function r(i){return arguments.length===0?r:arguments.length===1?o(i):arguments.length>=n?e.apply(null,arguments):ar(o(i),sr.slice.call(arguments,1))}}var V=Hn;function G(){}var cr=B($,{is:G,tag:G,data:function(e,t,n){for(e in n)n[e]===void 0&&delete n[e];Object.assign(t.dataset,n)},dataset:function(e,t,n){for(e in n)n[e]===void 0&&delete n[e];Object.assign(t.dataset,n)},html:function(e,t,n){t.innerHTML=n},text:function(e,t,n){t.textContent=n},style:B((e,t,n)=>typeof n,{string:(e,t,n)=>t.style=n,object:(e,t,n)=>Object.assign(t.style,n)}),children:function(e,t,n){t.innerHTML="",t.append.apply(t,n)},href:function(e,t,n){t instanceof SVGElement?t.setAttribute("href",n):t.href=n},points:X,cx:X,cy:X,r:X,x:X,y:X,dx:X,dy:X,transform:X,preserveAspectRatio:X,viewBox:X,default:function(e,t,n){e in t?t[e]=n:t.setAttribute(e,n)}});function X(e,t,n){t.setAttribute(e,n)}function ur(e,t){for(var n=Object.keys(t),o=n.length;o--;)t[n[o]]!==void 0&&cr(n[o],e,t[n[o]]);return e}var Ut=V(ur,!0);var Ne="http://www.w3.org/2000/svg",Un=document.createElement("template"),Te=(e,t)=>t&&typeof t;function In(e,t=""){let n=document.createRange();return n.selectNode(e),n.createContextualFragment(t)}var M=B(Te,{string:function(e,t){let n=document.createElementNS(Ne,e);return n.innerHTML=t,n},object:function(e,t){let n=document.createElementNS(Ne,e);return typeof t.length=="number"?n.append.apply(n,t):Ut(n,t),n},default:e=>document.createElementNS(Ne,e)}),lr=B(Te,{string:function(e,t){let n=document.createElement(e);return n.innerHTML=t,n},object:function(e,t){let n=document.createElement(e);return typeof t.length=="number"?n.append.apply(n,t):Ut(n,t),n},default:e=>document.createElement(e)}),pr=B($,{comment:function(e,t){return document.createComment(t||"")},fragment:B(Te,{string:function(e,t,n){return n?In(n,t):(Un.innerHTML=t,Un.content.cloneNode(!0))},object:function(e,t,n){let o=n?In(n):document.createDocumentFragment();return typeof t.length=="number"?o.append.apply(o,t):Ut(o,t),o},default:()=>document.createDocumentFragment()}),circle:M,ellipse:M,g:M,glyph:M,image:M,line:M,rect:M,use:M,path:M,pattern:M,polygon:M,polyline:M,svg:M,tspan:M,text:M,default:lr}),b=pr;function ke(e,t,n){let o;typeof n!="string"&&n.input!==void 0&&n.index!==void 0&&(o=n,n=o.input.slice(n.index+n[0].length+(n.consumed||0)));let r=e.exec(n);if(!r)return;let i=t(r);return o&&(o.consumed=(o.consumed||0)+r.index+r[0].length+(r.consumed||0)),i}var Fc=V(ke,!0);function hr(e,t,n){throw n.input!==void 0&&n.index!==void 0&&(n=n.input),new Error('Cannot parse string "'+(n.length>128?n.length.slice(0,128)+"â€¦":n)+'"')}function fr(e,t,n){let o=-1;for(;++o<n.length;)t=n[o]!==void 0&&e[o]?e[o](t,n):t;return e.done?e.done(t,n):e.close?e.close(t,n):t}function dr(e,t,n,o){let r=ke(e,i=>fr(t,n,i),o);return r===void 0?t.catch?t.catch(n,o):hr(e,t,o):r}var Xn=V(dr,!0);var Wn=Symbol("internals");function Ge(e,t,n){return t[Wn]=t.attachInternals&&!t.getAttribute("is")?t.attachInternals():{shadowRoot:n}}function y(e){return e[Wn]}var jn=Object.defineProperties;var Pe={},mr={name:{set:function(e){return this.setAttribute("name",e)},get:function(){return this.getAttribute("name")||""}},form:{get:function(){return y(this).form}},labels:{get:function(){return y(this).labels}},validity:{get:function(){return y(this).validity}},validationMessage:{get:function(){return y(this).validationMessage}},willValidate:{get:function(){return y(this).willValidate}},checkValidity:{value:function(){return y(this).checkValidity()}},reportValidity:{value:function(){return y(this).reportValidity()}}},Oe=!1,gr=Xn(/^\s*<?([a-z][\w]*-[\w-]+)>?\s*$|^\s*<?([a-z][\w]*)\s+is[=\s]*["']?([a-z][\w]*-[\w-]+)["']?>?\s*$/,{1:(e,t)=>({name:t[1]}),2:(e,t)=>({name:t[3],tag:t[2]}),catch:function(e,t){throw new SyntaxError(`dom element() â€“ name must be of the form 'element-name' or 'tag is="element-name"' (`+t+")")}},null),zn={once:!0};function xr(e){return e.sheet?Promise.resolve({target:e}):new Promise((t,n)=>{e.addEventListener("load",t,zn),e.addEventListener("error",n,zn)})}function wr(e){e.stop()}function Er(e){if(Pe[e])return Pe[e];let t=document.createElement(e).constructor;if(t===HTMLUnknownElement)throw new Error("Cannot define customised built-in - constructor for <"+e+"> is HTMLUnknownElement");return Pe[e]=t}function yr(e,t){if(e.hasOwnProperty(t)){let n=e[t];delete e[t],e[t]=n}return e}function Kn(e,t){let n=e.attachShadow({mode:t.mode||"closed",delegatesFocus:t.focusable||!1});if(t.stylesheet){let o=b("link",{rel:"stylesheet",href:t.stylesheet});n.append(o)}return n}function br(e,t){return typeof t=="string"?t[0]==="#"?e.appendChild(document.getElementById(t.slice(1)).content.clone(!0)):e.innerHTML=t:e.appendChild(t.content.clone(!0)),e}function vr(e){let t=e.isUpgraded;return e.isUpgraded=!0,!t}function Vn(e,t){return Array.from(e.querySelectorAll('[is="'+t+'"]')).filter(vr)}var Dr=B((e,t)=>typeof t,{object:(e,t)=>t,function:(e,t)=>({value:t}),default:(e,t)=>{throw new TypeError("element() does not accept property descriptor of type "+typeof t)}});function Me(e,t={},n={},o=""){let{name:r,tag:i}=gr(e),a=typeof i=="string"?Er(i):HTMLElement,c=[],s={},l,f;for(l in n)f=Dr(l,n[l]),f.attribute&&c.push(l),(f.set||f.get||"value"in f)&&(s[l]=f),n[l]=f;function p(){let u=Reflect.construct(a,arguments,p),d=t.mode||typeof t.shadow=="string"?Kn(u,t):void 0;t.shadow&&br(d,t.shadow);let m=Ge(p,u,d);return i&&(Oe=!0),t.construct&&t.construct.call(u,d,m),Object.keys(s).reduce(yr,u),u}if(p.prototype=Object.create(a.prototype,s),n.value&&(p.formAssociated=!0,jn(p.prototype,mr),(t.enable||t.disable)&&(p.prototype.formDisabledCallback=function(u){let d=y(this);return u?t.disable&&t.disable.call(this,d.shadowRoot,d):t.enable&&t.enable.call(this,d.shadowRoot,d)}),t.reset&&(p.prototype.formResetCallback=function(){let u=y(this);return t.reset.call(this,u.shadowRoot,u)}),t.restore&&(p.prototype.formStateRestoreCallback=function(){let u=y(this);return t.restore.call(this,u.shadowRoot,u)})),c.length&&(p.observedAttributes=c,p.prototype.attributeChangedCallback=function(u,d,m){return n[u].attribute.call(this,m)}),t.connect&&(p.prototype.connectedCallback=function(){let u=y(this),d=u.shadowRoot;if(u.stopable=t.connect.call(this,d,u),!d)return;let m=d.querySelectorAll('link[rel="stylesheet"]');if(m.length){let h=b("style","*:not(slot), slot:not([name]) { display: none !important; }");d.prepend(h);let g;u.loadPromise?g=u.loadPromise.then(()=>new Promise(requestAnimationFrame)):g=u.loadPromise=Promise.all(Array.from(m,xr)),g.finally(()=>{h.remove(),t.load&&t.load.call(this,d,u)})}else t.load&&t.load.call(this,d,u)}),p.prototype.disconnectedCallback=function(){let u=y(this);u.stopable&&(u.stopable.stop?u.stopable.stop():u.stopable.forEach(wr)),t.disconnect&&t.disconnect.call(this,u.shadowRoot,u)},window.console&&window.console.log("%c<"+(i?i+" is="+r:r)+">%c "+o,"color:#3a8ab0;font-weight:600;","color:#888888;font-weight:400;"),window.customElements.define(r,p,i&&{extends:i}),i&&!Oe){let u=document.createElement("div");if(u.style.position="fixed",u.style.left="-1000px",u.style.top="-1000px",u.innerHTML="<"+i+' is="'+r+'"></'+i+">",document.body.append(u),u.remove(),Oe)p.polyfillByRoot=G;else{let d=function(h){let g={};Object.keys(s).forEach(C=>{h[C]!==void 0&&(g[C]=h[C])}),jn(h,s);let x=t.mode||t.shadow?Kn(h,t):void 0,w=Ge(p,h,x);t.construct&&t.construct.call(h,x,w),Object.assign(h,g);let E=-1,T;for(;T=c[++E];){let C=h.attributes[T];C&&n[T].attribute.call(h,C.value)}t.connect&&t.connect.call(h,x,w)},m=function(h){Vn(h,r).forEach(d),new MutationObserver(()=>Vn(h,r).forEach(d)).observe(h,{childList:!0,subtree:!0})};p.polyfillByRoot=m,m(document)}}else p.polyfillByRoot=G;return p}var It=e=>typeof e;var Sr=Object.defineProperties,Jn=B(It,{function:e=>e(),object:e=>e.stop()}),et=class extends ${#t;stop(){if(this.status==="done")return this;this.status="done";let t=this.#t;return this.#t=void 0,t&&t.forEach(Jn),this}done(t){return this.status==="done"?(Jn(listener),this):((this.#t||(this.#t=[])).push(t),this)}};Sr(et.prototype,{status:{writable:!0}});function Cr(e){throw new TypeError("Stream cannot be created .from() "+typeof e)}function L(e,t){if(t===void 0)return;let n=-1;for(;e[++n];)e[n].push(t);return e}function Ar(e){et.prototype.stop.apply(e);let t=-1,n;for(;n=e[++t];)e[t]=void 0,n.stop&&(We(n,e),n[-1]||n.stop());return e}function We(e,t){let n=0;for(;e[--n]&&e[n]!==t;);for(;e[n--];)e[n+1]=e[n]}function Qn(e,t){let n=-1;for(;e[++n]&&e[n]!==t;);for(;e[n++];)e[n-1]=e[n]}function Br(e,t){We(t,e),Qn(e,t)}var bt=class extends et{stop(){if(this.status==="done")return this;let t;for(;t=this[-1];){let n=-1;for(;this[n--];)this[n+1]=this[n];Qn(t,this),t.stop&&!t[0]&&t.stop(t)}return super.stop()}},Xt=class extends bt{constructor(t){super(),this.push=t}},Wt=class extends bt{constructor(t,n){super(),this.fn=t,this.value=n,this.i=0}push(t){let n=this.fn;this.value=n(this.value,t,this.i++,this)}},P=class extends bt{start(){if(this.status)return this;let t=0,n;t:for(;n=this[--t];){let o=-1;for(;n[++o];)if(n[o]===this)continue t;n[o]=this,o===0&&n.start&&n.start()}return this}stop(){if(this.status==="done")return this;super.stop();let t=-1,n;for(;n=this[++t];)this[t]=void 0,n.stop&&(We(n,this),n[-1]||n.stop());return this}pipe(t){if(t.stop){let o=0;for(;t[--o]&&t[o]!==this;);t[o]=this}if(t.start&&!(t[0]||t.status==="running"))return t;let n=-1;for(;this[++n]&&this[n]!==t;);return this[n]=t,n||this.start(),t}each(t){return this.pipe(new Xt(t))}buffer(...t){return this.pipe(new pt(t))}filter(t){return this.pipe(new qe(t))}flatMap(t){return this.pipe(new $e(t))}map(t){return this.pipe(new zt(t))}reduce(t,n){return this.pipe(new Wt(t,n)).value}scan(t,n){return this.pipe(new Ue(t,n))}slice(t,n){return this.pipe(new Ie(t,n))}split(t){return this.pipe(new Xe(t))}[Symbol.asyncIterator]=async function*(){let t=[],n=r=>t.push(r);function o(r,i){n=r}for(this.each(r=>n(r)).done(()=>n=G);n!==G;)yield t.length?t.shift():await new Promise(o)};static from=B(It,{function:t=>new zt(t),object:t=>typeof t.pipe=="function"?t:typeof t.then=="function"?new Le(t):typeof t.length=="number"?new pt(Array.from(t)):Cr(t)});static of(...t){return t.length<2?new jt(t[0]):new pt(t)}static buffer(t){return new pt(t)}static value(t){return new jt(t)}static merge(...t){return new He(t)}static push=L;static stop=Ar;static unpipe=Br;static each(t){return new Xt(t)}static reduce(t,n){return new Wt(t,n)}},Le=class extends P{constructor(t){super(),this.promise=t}start(){return this.promise.then(t=>L(this,t)).finally(()=>this.stop()),this}},jt=class extends P{constructor(t){super(),this.value=t}start(){return this.value!==void 0&&(L(this,this.value),this.status==="done")?this:super.start()}push(t){return this.value=t,L(this,t)}},pt=class extends P{constructor(t){super(),this.values=t||[]}start(){let t=this.values;if(!t)return super.start();let n=-1;for(;n++<t.length;)if(L(this,t[n]),this.status==="done")return this;return this.values=void 0,super.start()}push(t){return this.value=t,this.values?this.values.push(this.value):L(this,this.value)}},qe=class extends P{constructor(t){super(),this.fn=t}push(t){let n=this.fn;return n(t)&&L(this,t)}},$e=class extends P{constructor(t){super(),this.fn=t}push(t){let n=this.fn,o=n(t);if(o!==void 0)if(isIterable(o))for(let r of o)L(this,r);else o.pipe?(console.warn("FlatMapping pipeables is dodgy. Map to arrays for the moment please."),this.done(o.each(r=>L(this,r)))):o.then&&o.then(r=>L(this,r))}},zt=class extends P{constructor(t){super(),this.fn=t}push(t){let n=this.fn,o=n(t);return o!==void 0&&L(this,o)}},He=class extends P{constructor(t){super(),this.inputs=t}push(t){return L(this,t)}pipe(t){let n=-1,o;for(;o=this.inputs[++n];)P.from(o).pipe(this);return P.prototype.pipe.call(this,t)}},Ue=class extends P{constructor(t,n){super(),this.fn=t,this.value=n}push(t){let n=this.fn;this.value=n(this.value,t),L(this,this.value)}},Ie=class extends P{constructor(t,n=1/0){super(),this.index=-t,this.indexEnd=n-t}push(t){++this.index>0&&L(this,t),this.index===this.indexEnd&&this.stop()}},Xe=class extends P{constructor(t){super(),this.chunk=[],typeof t=="number"?this.n=t:this.fn=t}fn(){return this.chunk.length===this.n}push(t){let n=this.chunk;this.fn(t)?(L(this,n),this.chunk=[]):n.push(t)}};var ou={fullscreenchange:lt(()=>"fullscreenElement"in document?"fullscreenchange":"webkitFullscreenElement"in document?"webkitfullscreenchange":"mozFullScreenElement"in document?"mozfullscreenchange":"msFullscreenElement"in document?"MSFullscreenChange":"fullscreenchange")},Rr=0;window.addEventListener("click",e=>Rr=e.timeStamp);function je(e){return function(){return arguments[e]}}function ze(e){return e}function nt(){}function W(){return this}var Zn=Object.create,Fr=Object.freeze,Yn=Fr(Zn(Zn(Object.prototype,{at:{value:nt},shift:{value:nt},push:{value:nt},forEach:{value:nt},join:{value:function(){return""}},every:{value:function(){return!0}},filter:{value:W},find:{value:nt},findIndex:{value:function(){return-1}},flat:{value:W},flatMap:{value:W},includes:{value:function(){return!1}},indexOf:{value:function(){return-1}},map:{value:W},reduce:{value:je(1)},sort:{value:W},each:{value:W},pipe:{value:ze},start:{value:W},stop:{value:W},done:{value:W},valueOf:{value:function(){return null}}}),{length:{value:0}}));function Ke(e,t){return(t%e+e)%e}var _n=e=>Ke(12,e);var Nr=/^([A-G][â™­â™¯#b]?)(-?\d)$/,Tr=/^[A-G][â™­â™¯#b]?/,kr=/-?\d$/,Gr=/[Hh]z$/,vt={C:0,"Câ™¯":1,"C#":1,"Dâ™­":1,Db:1,D:2,"Dâ™¯":3,"D#":3,"Eâ™­":3,Eb:3,E:4,F:5,"Fâ™¯":6,"F#":6,"Gâ™­":6,Gb:6,G:7,"Gâ™¯":8,"G#":8,"Aâ™­":8,Ab:8,A:9,"Aâ™¯":10,"A#":10,"Bâ™­":10,Bb:10,B:11},Ve={27:"High Q",28:"Slap",29:"Scratch Push",30:"Scratch Pull",31:"Sticks",32:"Square Click",33:"Metronome Click",34:"Metronome Bell",35:"Low Bass Drum",36:"High Bass Drum",37:"Side Stick",38:"Snare Drum 1",39:"Hand Clap",40:"Snare Drum 2",41:"Low Floor Tom",42:"Closed Hi-hat",43:"High Floor Tom",44:"Pedal Hi-hat",45:"Low Tom",46:"Open Hi-hat",47:"Low Mid Tom",48:"High Mid Tom",49:"Crash Cymbal 1",50:"High Tom",51:"Ride Cymbal 1",52:"Chinese Cymbal",53:"Ride Bell",54:"Tambourine",55:"Splash Cymbal",56:"Cowbell",57:"Crash Cymbal 2",58:"Vibra Slap",59:"Ride Cymbal 2",60:"High Bongo",61:"Low Bongo",62:"Mute High Conga",63:"Open High Conga",64:"Low Conga",65:"High Timbale",66:"Low Timbale",67:"High Agogo",68:"Low Agogo",69:"Cabasa",70:"Maracas",71:"Short Whistle",72:"Long Whistle",73:"Short Guiro",74:"Long Guiro",75:"Claves",76:"High Wood Block",77:"Low Wood Block",78:"Mute Cuica",79:"Open Cuica",80:"Mute Triangle",81:"Open Triangle",82:"Shaker",83:"Jingle Bell",84:"Belltree",85:"Castanets",86:"Mute Surdo",87:"Open Surdo"};function to(e){return e.toLowerCase().replace(/\s+/g,"-")}for(let e in Ve)vt[to(Ve[e])]=parseInt(e,10);var Pr=69;function Or(e,t=440){var n=Pr+12*Math.log(e/t)/Math.log(2);return Math.fround(n)}function D(e){if(typeof e=="number")return e;if(Gr.test(e))return Or(parseFloat(e));let t=Nr.exec(e);return t?(parseInt(t[2],10)+1)*12+vt[t[1]]:vt[to(e)]}function R(e){return typeof e=="number"?_n(e):vt[Tr.exec(e)[0]]}var Kt=["C","Câ™¯","D","Eâ™­","E","F","Fâ™¯","G","Gâ™¯","A","Bâ™­","B"];function J(e){return H(e)+Vt(e)}function H(e){return Kt[_n(e)]}function Vt(e){return typeof e=="number"?Math.floor(e/12)-1:Number(vt[(kr.exec(name)||Yn)[0]])}function eo(e){let t=D(e);return Ve[t]||""}function Je(e){var t={};return function(o){return o in t?t[o]:t[o]=e(o)}}function Jt(e){return function(n,...o){var r=e[n]||e.default;return r&&r.apply(this,o)}}var Mr={xml:"application/xml",html:"text/html",svg:"image/svg+xml"};function Qe(e,t){if(t){var n=Mr[e.toLowerCase()]||e,o;try{o=new window.DOMParser().parseFromString(t,n)}catch{return}if(!o||o.getElementsByTagName("parsererror").length)throw new Error("Invalid "+e.toUpperCase()+": "+t);return o}}function no(e){return Qe("html",e)}function oo(e){return Qe("svg",e)}var Z=Object.assign,ht={headers:function(e){return{}},body:$},Lr=Jt({"application/x-www-form-urlencoded":function(e){return Z(e,{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"})},"application/json":function(e){return Z(e,{"Content-Type":"application/json; charset=utf-8","X-Requested-With":"XMLHttpRequest"})},"multipart/form-data":function(e){return Z(e,{"Content-Type":"multipart/form-data","X-Requested-With":"XMLHttpRequest"})},"audio/wav":function(e){return Z(e,{"Content-Type":"audio/wav","X-Requested-With":"XMLHttpRequest"})},"image/png":function(e){return Z(e,{"Content-Type":"image/png","X-Requested-With":"XMLHttpRequest"})},"image/jpg":function(e){return Z(e,{"Content-Type":"image/jpg","X-Requested-With":"XMLHttpRequest"})},"image/jpeg":function(e){return Z(e,{"Content-Type":"image/jpeg","X-Requested-With":"XMLHttpRequest"})},default:function(e){return Z(e,{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"})}}),qr=Jt({"application/json":function(e){return e instanceof FormData?$r(e):JSON.stringify(e)},"application/x-www-form-urlencoded":function(e){return e instanceof FormData?io(e):so(e)},"multipart/form-data":function(e){return e instanceof FormData?e:Hr(e)},default:$});function $r(e){return JSON.stringify(Array.from(e.entries()).reduce(function(t,n){return t[n[0]]=n[1],t},{}))}function io(e){return new URLSearchParams(e).toString()}function so(e){return Object.keys(e).reduce((t,n)=>(t.append(n,e[n]),t),new URLSearchParams)}function Hr(e){throw new Error("TODO: dataToFormData(data)")}function Ur(e,t){return t instanceof FormData?e+"?"+io(t):e+"?"+so(t)}function Ir(e,t,n,o){let r=typeof n=="string"?n:n&&n["Content-Type"]||"application/json",i=Lr(r,Z(ht.headers&&t?ht.headers(t):{},typeof n=="string"?{}:n)),a={method:e,mode:"cors",headers:i,credentials:"same-origin",signal:o&&o.signal};return e!=="GET"&&(a.body=qr(r,ht.body?ht.body(t):t)),a}function Qt(e){return e.blob()}function Xr(e){return e.json().catch(t=>{throw new Error("Cannot parse JSON "+e.url+". "+t.message)})}function ro(e){return e.formData()}function Wr(e){return e.text()}function jr(e){return e.text().then(t=>/^\s*<!DOCTYPE html>/.test(t)?no(t):b("fragment",t))}function zr(e){return e.text().then(t=>/^\s*<\?xml/.test(t)?oo(t):(console.warn("Untested SVG fragment parsing in request.js!"),b("fragment",t)))}var Kr={"text/plain":Wr,"text/html":jr,"image/svg+xml":zr,"application/json":Xr,"multipart/form-data":ro,"application/x-www-form-urlencoded":ro,audio:Qt,"audio/wav":Qt,"audio/m4a":Qt,"application/zip":Qt};function Vr(e){if(ht.onresponse&&(e=ht.onresponse(e)),!e.ok)throw new Error(e.statusText+"");let t=e.headers.get("Content-Type");if(!t)return;let n=t.replace(/\;.*$/,"");return Kr[n](e)}function ao(e="GET",t,n={},o="application/json"){e=e.toUpperCase(),e==="GET"&&n&&(t=Ur(t,n));let r=Ir(e,n,o,arguments[4]);return fetch(t,r).then(Vr)}function co(e){return ao("GET",e)}var Jr={chord:3,note:3,key:1,meter:2,rate:1,lyric:2},Qr=/^[ABCDEFG][bâ™­#â™¯]{0,1}-?\d$/,uo=/^[ABCDEFG][bâ™­#â™¯]{0,1}/;function Ze(e){let t=e.trim().split(/\s+/),n=[],o=-1;for(;t[++o]!==void 0;){let r=Number(t[o]),i=t[++o];Qr.test(i)?(i="note",--o):uo.test(i)&&(i="chord",--o);let a=[r,i],c=Jr[i];if(c===void 0)throw new TypeError('Unrecognised type "'+i+'" in sequence data');if(i==="chord"){let s=uo.exec(t[++o])[0],l=t[o].slice(s.length)||t[++o],f=Number(t[++o]);a.push(s,l,f)}else for(;c--;){let s=Number(t[++o]);a.push(Number.isNaN(s)?t[o]:s)}n.push(a)}return n}function Zr(e){let t=e.files[Object.keys(e.files)[0]];return ot(t.type,t.content)}function Yr(e){let t=e.settings.find(matches({id:13324}))||e.settings[0];return ot("abc",t.abc)}function ot(e,t){if(typeof t=="object")return t.files?Zr(t):t.settings?Yr():Array.isArray(t)?{id:0,events:t}:t;if(e==="sequence"||e==="text/plain")return{events:Ze(t)};{let n=JSON.parse(t);return Array.isArray(n)?{id:0,events:n}:n}}var _r=Je(co);var lo=B((e,t)=>typeof t,{string:function(e,t){return _r(t).then(n=>ot(e,n)).catch(n=>console.error(n))},default:function(e,t,n,o){t[e]=o}});var ti=/^(\d+)\/(\d+)$/;function po(e){let t=ti.exec(e),n=parseInt(t[1],10),o=4/parseInt(t[2],10);return{1:"meter",2:n*o,3:o}}function ho(e){let t=e[2],n=e[3],o=t/n,r=4/n;return o+"/"+r}var N={};or(N,{acciDoubleFlat:()=>Ye,acciDoubleSharp:()=>_e,acciFlat:()=>Yt,acciNatural:()=>_t,acciParensLeft:()=>fi,acciParensRight:()=>di,acciSharp:()=>te,augmentationDot:()=>qi,barLine:()=>as,barRepeat1:()=>cs,barRepeat2:()=>us,barRepeat4:()=>ls,barRepeatBegin:()=>ds,barRepeatDots:()=>xs,barRepeatEnd:()=>ms,barRepeatEndBegin:()=>gs,barRepeatLowerDot:()=>fs,barRepeatSlash:()=>ps,barRepeatUpperDot:()=>hs,chordAugmented:()=>Ns,chordBassSlash:()=>un,chordBracketLeft:()=>Os,chordBracketRight:()=>Ms,chordDiminished:()=>Rs,chordGlyphs:()=>Ls,chordHalfDiminished:()=>Fs,chordMajorSeventh:()=>Ts,chordMinor:()=>ks,chordParensLeftTall:()=>Gs,chordParensRightTall:()=>Ps,clefAlto:()=>At,clefBass:()=>Bt,clefDrum:()=>Zt,clefTreble:()=>Dt,clefTrebleDown:()=>St,clefTrebleUp:()=>Ct,coda:()=>cn,graceNoteStemDown:()=>Ki,graceNoteStemUp:()=>zi,head1:()=>mi,head2:()=>gi,head4:()=>xi,headBracketLeft:()=>tn,headBracketRight:()=>en,headCircle:()=>Di,headCircleX:()=>Si,headDiamond:()=>Ei,headDiamondWide:()=>yi,headPlus:()=>vi,headSlashHorizontalEnds:()=>Bi,headSlashVerticalEnds:()=>Ai,headSlashed2:()=>wi,headTriangleUp:()=>Ci,headX:()=>bi,metDot:()=>ji,metNote05Down:()=>Wi,metNote05Up:()=>Ui,metNote1Down:()=>Xi,metNote1Up:()=>Hi,metNote2Down:()=>Ii,metNote2Up:()=>$i,note0125Down:()=>Li,note0125Up:()=>ki,note025Down:()=>Mi,note025Up:()=>Ti,note05Down:()=>Oi,note05Up:()=>Ni,note1Down:()=>Pi,note1Up:()=>Fi,note2Down:()=>Gi,note2Up:()=>Ri,rest0125:()=>nn,rest01875:()=>ts,rest025:()=>on,rest0375:()=>es,rest05:()=>rn,rest075:()=>ns,rest1:()=>sn,rest15:()=>os,rest2:()=>an,rest3:()=>rs,rest4:()=>is,rest6:()=>ss,tailDown0125:()=>_i,tailDown025:()=>Zi,tailDown05:()=>Ji,tailUp0125:()=>Yi,tailUp025:()=>Qi,tailUp05:()=>Vi,textBeam16Long:()=>Ks,textBeam16Short:()=>zs,textBeam8Long:()=>js,textBeam8Short:()=>Ws,textDot:()=>Vs,textNote16Long:()=>Xs,textNote16Short:()=>Is,textNote8Long:()=>Us,textNote8Short:()=>Hs,textNoteLong:()=>$s,textNoteShort:()=>qs,textTie:()=>Js,textTuplet3Long:()=>ta,textTuplet3Short:()=>Zs,textTupletBeginLong:()=>_s,textTupletBeginShort:()=>Qs,textTupletEndLong:()=>ea,textTupletEndShort:()=>Ys,timeSig0:()=>ei,timeSig1:()=>ni,timeSig2:()=>oi,timeSig3:()=>ri,timeSig4:()=>ii,timeSig5:()=>si,timeSig6:()=>ai,timeSig7:()=>ci,timeSig8:()=>ui,timeSig9:()=>li,timeSigCommon:()=>pi,timeSigCutCommon:()=>hi,tuplet0:()=>ws,tuplet1:()=>Es,tuplet2:()=>ys,tuplet3:()=>bs,tuplet4:()=>vs,tuplet5:()=>Ds,tuplet6:()=>Ss,tuplet7:()=>Cs,tuplet8:()=>As,tuplet9:()=>Bs});var Dt="&#xE050;",St="&#xE052;",Ct="&#xE053;",At="&#xE05C;",Bt="&#xE062;",Zt="&#xE069;",ei="&#xE080;",ni="&#xE081;",oi="&#xE082;",ri="&#xE083;",ii="&#xE084;",si="&#xE085;",ai="&#xE086;",ci="&#xE087;",ui="&#xE088;",li="&#xE089;",pi="&#xE08A;",hi="&#xE08B;",Ye="&#xE264;",Yt="&#xE260;",_t="&#xE261;",te="&#xE262;",_e="&#xE263;",fi="&#xE26A;",di="&#xE26B;",mi="&#xE0A4;",gi="&#xE0A3;",xi="&#xE0A2;",tn="&#xE0F5;",en="&#xE0F6;",wi="&#xE0D0;",Ei="&#xE0DB;",yi="&#xE0DC;",bi="&#xE0A9;",vi="&#xE0AF;",Di="&#xE0E8;",Si="&#xE0B3;",Ci="&#xE0BE;",Ai="&#xE100;",Bi="&#xE101;",Ri="&#xE1D3;",Fi="&#xE1D5;",Ni="&#xE1D7;",Ti="&#xE1D9;",ki="&#xE1DB;",Gi="&#xE1D4;",Pi="&#xE1D6;",Oi="&#xE1D8;",Mi="&#xE1DA;",Li="&#xE1DC;",qi="&#xE1E7;",$i="&#xECA3;",Hi="&#xECA5;",Ui="&#xECA7;",Ii="&#xECA4;",Xi="&#xECA6;",Wi="&#xECA8;",ji="&#xECB7;",zi="&#xE560;",Ki="&#xE561;",Vi="&#xE240;",Ji="&#xE241;",Qi="&#xE242;",Zi="&#xE243;",Yi="&#xE244;",_i="&#xE245;",nn="&#xE4E8;",ts="&#xE4E8;&#xE1E7;",on="&#xE4E7;",es="&#xE4E7;&#xE1E7;",rn="&#xE4E6;",ns="&#xE4E6;&#xE1E7;",sn="&#xE4E5;",os="&#xE4E5;&#x200A;&#xE1E7;",an="&#xE4E4;",rs="&#xE4E4;&#x200A;&#xE1E7;",is="&#xE4E3;",ss="&#xE4E3;&#x200A;&#xE1E7;",as="&#xE030",cs="&#xE500;",us="&#xE501;",ls="&#xE502;",ps="&#xE504;",hs="&#xE503;",fs="&#xE505;",ds="&#xE040",ms="&#xE041",gs="&#xE042",xs="&#xE043",cn="&#xE048",ws="&#xE880;",Es="&#xE881;",ys="&#xE882;",bs="&#xE883;",vs="&#xE884;",Ds="&#xE885;",Ss="&#xE886;",Cs="&#xE887;",As="&#xE888;",Bs="&#xE889;",Rs="&#xE870;",Fs="&#xE871;",Ns="&#xE872;",Ts="&#xE873;",ks="&#xE874;",Gs="&#xE875;",Ps="&#xE876;",Os="(",Ms=")",un="&#xE87B;",Ls={"âˆ†â™¯11":"î¡³îµ¢11","âˆ†":"î¡³",7:"7","-7":"î¡´7","-â™­6":"î¡´îµ 6","7susâ™­9":"7susîµ¢",Ã¸:"î¡±","7â™¯11":"7îµ¢11","-âˆ†":"î¡´î¡³","âˆ†â™­6":"î¡³îµ 6","-â™­9":"î¡´îµ 9",Ã¸7:"î¡±7","âˆ†â™¯5":"î¡³îµ¢5","7alt":"7alt","Â°":"î¡°",dim:"î¡°","7â™­9":"7îµ ","+7":"î¡²7"},qs="&#xE1F0;",$s="&#xE1F1;",Hs="&#xE1F2;",Us="&#xE1F3;",Is="&#xE1F4;",Xs="&#xE1F5;",Ws="&#xE1F7;",js="&#xE1F8;",zs="&#xE1F9;",Ks="&#xE1FA;",Vs="&#xE1FC;",Js="&#xE1FD;",Qs="&#xE1FE",Zs="&#xE1FF",Ys="&#xE200",_s="&#xE201",ta="&#xE202",ea="&#xE203";function ln(e){return function(){return arguments[e]}}function j(){return this}var fo=Object.create,na=Object.freeze,ee=na(fo(fo(Object.prototype,{at:{value:G},shift:{value:G},push:{value:G},forEach:{value:G},join:{value:function(){return""}},every:{value:function(){return!0}},filter:{value:j},find:{value:G},findIndex:{value:function(){return-1}},flat:{value:j},flatMap:{value:j},includes:{value:function(){return!1}},indexOf:{value:function(){return-1}},map:{value:j},reduce:{value:ln(1)},sort:{value:j},each:{value:j},pipe:{value:$},start:{value:j},stop:{value:j},done:{value:j},valueOf:{value:function(){return null}}}),{length:{value:0}}));var oa=/b|#/g,ra={b:"â™­","#":"â™¯"};function ia(e){return ra[e]}function pn(e){switch(e[1]){case"chord":e[2]=R(e[2]),e[3]=e[3].replaceAll(oa,ia);break;case"lyric":console.warn('Old data contains "lyric" event, should be "text"'),e[1]="text";break;case"key":e[2]=R(e[2]);break;case"note":e[2]=D(e[2]);break}return e}var sa=Object.assign,ne=Object.defineProperty,oe={writable:!0};function aa(e){let t=[],n=-1;for(;e[++n]!==void 0;)t.push(e[n]);return t}function ft(e){return e.toFixed(4).replace(/\.?0+$/,"")}var dt=class e{constructor(){sa(this,pn(arguments)),ne(this,"event",oe),ne(this,"events",oe),ne(this,"index",oe),ne(this,"target",oe)}toJSON(){return aa(this)}toString(){let t=ft(this[0])+" "+this[1];switch(this[1]){case"chord":t+=" "+H(this[2])+" "+this[3]+" "+ft(this[4]);break;case"key":t+=" "+H(this[2]);break;case"note":t+=" "+J(this[2])+" "+this[3]+" "+ft(this[4]);break;case"param":t+=" "+this[2]+" "+this[3]+" "+ft(this[4])+" "+this[5];break;case"rate":t+=" "+ft(this[2]);break;case"sequence":t+=" "+this[2]+" "+this[3]+" "+ft(this[4]);break;case"start":case"stop":t+=" "+J(this[2])+" "+this[3];break;default:let n=1;for(;this[++n]!==void 0;)t+=this[n]}return t}static of(...t){return new e(...t)}static from(t,n,o){let r=new e(...t);return r.event=t,r.events=n,r.index=o,r}static isChordEvent=hn;static isNoteEvent=re;static isSequenceEvent=ca};function hn(e){return e[1]==="chord"}function re(e){return e[1]==="note"}function ca(e){return e[1]==="sequence"}function ua(e,t){return t[e]}var rt=V(ua,!0);var mo=B(rt(1),{chord:e=>e[4],lyric:e=>e[3],note:e=>e[4],sequence:e=>e[4],default:e=>0});function F(e){return e[0]+mo(e)}function mt(e,t){return(t%e+e)%e}function Y(e){return mt(12,e)}function go(e,t){return e>t?1:e<t?-1:0}var q=[0,2,4,5,7,9,11];function la(e,t,n){return n.indexOf(e)===t}function xo(e,t){return e.map(n=>Y(n+t)).filter(la).sort(go)}var gn=[{name:"C",symbol:"Câˆ†",spellings:[0,1,0,-1,0,0,1,0,-1,0,-1,0]},{name:"Dâ™­",symbol:"Dâ™­âˆ†",spellings:[0,-1,0,-1,-1,0,-1,0,-1,0,-1,-1]},{name:"D",symbol:"Dâˆ†",spellings:[0,1,0,1,0,0,1,0,1,0,-1,0]},{name:"Eâ™­",symbol:"Eâ™­âˆ†",spellings:[0,-1,0,-1,0,0,-1,0,-1,0,-1,-1]},{name:"E",symbol:"Eâˆ†",spellings:[0,1,0,1,0,1,1,0,1,0,1,0]},{name:"F",symbol:"Fâˆ†",spellings:[0,-1,0,-1,0,0,1,0,-1,0,-1,0]},{name:"Fâ™¯",symbol:"Fâ™¯âˆ†",spellings:[1,1,0,1,0,1,1,0,1,0,1,0]},{name:"G",symbol:"Gâˆ†",spellings:[0,1,0,-1,0,0,1,0,1,0,-1,0]},{name:"Aâ™­",symbol:"Aâ™­âˆ†",spellings:[0,-1,0,-1,-1,0,-1,0,-1,0,-1,-1]},{name:"A",symbol:"Aâˆ†",spellings:[0,1,0,1,0,0,1,0,1,0,1,0]},{name:"Bâ™­",symbol:"Bâ™­âˆ†",spellings:[0,-1,0,-1,0,0,-1,0,-1,0,-1,0]},{name:"B",symbol:"Bâˆ†",spellings:[1,1,0,1,0,1,1,0,1,0,1,0]}];function gt(e){return xo(q,e)}var{abs:ml}=Math,pa={"":[0,4,7],"âˆ†":[0,4,7,11],"âˆ†7":[0,4,7,11],"âˆ†â™¯11":[0,4,6,7,11],7:[0,4,7,10],13:[0,4,7,9,10],"7sus":[0,5,7,10],"-":[0,3,7],"-7":[0,3,7,10],"-11":[0,3,5,7],"-13":[0,3,7,9],"-â™­6":[0,3,7,8],"7susâ™­9":[0,1,5,7,10],Ã¸:[0,3,6,10],"-âˆ†":[0,3,7,11],"7â™¯11":[0,4,6,7,10],"âˆ†â™­6":[0,4,7,8],"-â™­9":[0,1,3,7],Ã¸7:[0,2,3,6,10],"âˆ†â™¯5":[0,2,4,6,8,9,11],"7alt":[0,1,3,4,6,8,10],"Â°":[0,3,6,9],"7â™­9":[0,1,4,7,10],"7â™¯9":[0,3,4,7,10],"7â™­13":[0,4,7,8,10],"+":[0,2,4,6,8,10],"+7":[0,2,4,6,8,10],dim:[0,3,6,9]},ha=Float32Array.of(1,.9,.8,1,1,.8,.8,1,.9,1,1,1),fa=[1,1/6+0+0,4/6+0+0,3/6+1/9+0,2/6+0+1/5,5/6+0+0,0+1/11+0,5/6+0+0,2/6+0+1/5,3/6+1/8+0,4/6+0+0,1/6+0+0],gl={3:[10/16,13/16,10/16],4:[10/16,13/16,10/16,12/16]};function dn(e){let t=new Float32Array(12),n=R(e+2),o=7;for(;o--;)n=R(n+5),t[n]=1;return t}function mn(e,t,n){let o=e.length;for(;o--;)e[o]*=1-n+n*t[o];return e}var fn={note:(e,t,n=1)=>{let o=D(t[2]),r=dn(o);return mn(e,r,n*(1-o/192))},chord:(e,t,n=1)=>{let o=R(t[2]),r=pa[t[3].replace(/\(|\)/g,"")];if(!r)return console.warn('No scale for chord extension "'+t[3]+'"'),e;let i=r.map(s=>R(o+s)),a=i.length,c;for(;a--;)c=dn(i[a]),mn(e,c,n/i.length*ha[r[a]]);return e}};function se(e,t,n){let o=e[t],r=o[0],i=re(o)?dn(D(o[2])):hn(o)?fn.chord(Float32Array.of(1,1,1,1,1,1,1,1,1,1,1,1),o):0;if(n!==void 0){let c=Float32Array.from({length:12},(s,l)=>fa[(l+12-n)%12]);mn(i,c,.3)}let a=t;for(;o=e[--a];){let c=fn[o[1]];if(!c)continue;let s=F(o);if(s>r)c(i,o,.5);else if(o[1]==="note"&&r-s<3){if(1-(r-s)/3>1)throw new Error("Influence should never be > 1 "+r+" "+s);c(i,o,.25*(1-(r-o[0])/3))}}for(a=t;(o=e[++a])&&o[0]-r<2;){if(!re(o))continue;let c=fn[o[1]];if(c){if(1-(o[0]-r)/2>1)throw new Error("Influence should never be > 1 "+r+" "+stopBeat);c(i,o,.3*(1-(o[0]-r)/2))}}return i}var ie=[0,7,5,2,10,9,3,4,8,11,1,6];function ae(e){let t=ie.length,n=0,o;for(;t--;)e[ie[t]]>n&&(n=e[ie[t]],o=ie[t]);return o}var Eo=/^([A-G])([b#â™­â™¯ð„«ð„ª])?(-?\d)?$/,Rt=/b|â™­/,Ft=/#|â™¯/;var ce=/b|â™­|#|â™¯/g,ue={"-2":"ð„«","-1":"â™­",0:"",1:"â™¯",2:"ð„ª"},wo=["Fâ™¯","Câ™¯","Gâ™¯","Dâ™¯","Aâ™¯","Eâ™¯","Bâ™¯","Bâ™­","Eâ™­","Aâ™­","Dâ™­","Gâ™­","Câ™­","Fâ™­"];function le(e,t){let n=wo.indexOf(e.pitch),o=wo.indexOf(t.pitch);return n>o?1:n<o?-1:0}var yo={"-2":"ð„«","-1":"â™­",0:"",1:"â™¯",2:"ð„ª"};function bo(e,t){let n=gn[e],o=R(t),r=n.spellings[Y(o)];return Kt[Y(o-r)]+yo[r]}function vo(e,t){let n=gn[e],o,r,i;if(typeof t=="string"){let[s,l,f,p]=Eo.exec(t)||[t];p&&(o=D(t),r=n.spellings[Y(o)],i=Vt(o-r))}else o=t,r=n.spellings[Y(o)],i=Vt(o-r);let a=Kt[Y(o-r)],c=yo[r];return a+c+i}var da=globalThis||window;var{floor:Do,round:kl}=Math,S=class{constructor(){}clef="";pitched=!0;rows=ee;getNoteHTML(t,n,o){let r=o>=4||Math.fround(o)===Math.fround(2.666666667)?"head4":o>=2||Math.fround(o)===Math.fround(1.333333333)?"head2":"head1";return`<span class="head" data-glyph="${r}">${N[r]}</span>`}get maxRow(){return 0}get topRow(){return this.centerRow-4}get centerRow(){return Do(.5*(this.rows.length-1))}get bottomRow(){return this.centerRow+5}get minRow(){return this.rows.length-1}get maxPitch(){return this.rows[this.maxRow]}get topPitch(){return this.rows[this.topRow]}get centerPitch(){return this.rows[this.centerRow]}get bottomPitch(){return this.rows[this.bottomRow]}get minPitch(){return this.rows[this.minRow]}movePitch(t,n){let o=D(this.minPitch),r=D(this.maxPitch),i=D(t)+n;return i>=o&&i<=r?i:void 0}parts=[{name:"main",top:"stave-top",center:"stave-center",bottom:"stave-bottom",DEFAULT:!0}];getPart(t){return this.parts[0]}getRow(t,n){let r=(typeof n=="string"?n:J(n)).replace(ce,""),i=this.rows.indexOf(r);if(da.DEBUG&&i===-1)throw new Error('Pitch "'+n+'" is not supported by stave '+this.constructor.name);return i===-1&&console.warn('Pitch "'+n+'" is not supported by stave '+this.constructor.name),i>-1?i:void 0}getSpelling(t,n){return n[1]==="chord"?bo(t,n[2]):vo(t,n[2])}createKeySymbols(t){let n=[],o=R(t),r=gt(o);return n.push.apply(n,r.map((i,a)=>i-q[a]&&{type:"acci",pitch:H(q[a])+ue[i-q[a]],value:i-q[a],part:this.parts[0]}).filter(i=>!!i).sort(le)),n}createSignatureSymbols(t){return[{type:"clef",clef:this.type,part:this.parts[0]}].concat(this.createKeySymbols(t))}yRatioToPitch(t){let n=Do(t*this.pitches.length);return n<0?this.pitches[0]:n>this.pitches.length-1?this.pitches[this.pitches.length-1]:this.pitches[n]}};var ma=globalThis||window;function So(e){return eo(e).toLowerCase().replace(/\s+/g,"-").replace(/-drum|-cymbal/,"")}var it=class extends S{type="drum";pitched=!1;rows=["","","","","splash chinese","crash-2","crash-1","ride-1 ride-2 ride-bell","closed-hi-hat open-hi-hat","high-tom cowbell","low-mid-tom high-mid-tom","snare-1 snare2 side-stick","low-tom sticks hand-clap tambourine","high-floor-tom","low-floor-tom","low-bass high-bass","","pedal-hi-hat","","","","","","",""];#t={31:"headX",37:"headCircle",39:"headX",42:"headX",44:"headX",46:"headCircleX",49:"headCircleX",51:"headX",52:"headCircleX",53:"headDiamond",54:"headX",55:"headX",56:"headTriangleUp",57:"headCircleX",58:"headTriangleUp",59:"headX"};getNoteHTML(t,n,o){let r=D(t),i=this.#t[r],a=N[i],c=i?`<span class="head" data-glyph="${i}">${a}</span>`:super.getNoteHTML(t,n,o);return n<.02?tn+c+en:c}parts={drums:{name:"drums",beam:"drums-beam",stemup:!1},cymbals:{name:"cymbals",beam:"cymbals-beam",stemup:!0}};getPart(t){return[35,36,37,38,40,41,43,44,45,47,50].includes(D(t))?this.parts.drums:this.parts.cymbals}getRow(t,n){let o=typeof n=="string"?n:So(n);if(!o)throw new Error("Drum name not found for pitch "+n);let r=this.rows.findIndex(i=>i.includes(o));if(ma.DEBUG&&r===-1)throw new Error('Pitch "'+o+'" is not supported by stave '+this.constructor.name);return r===-1&&console.warn('Pitch "'+o+'" is not supported by stave '+this.constructor.name),r>-1?r:void 0}getSpelling(t,n){return n[1]==="note"?So(D(n[2])):super.getSpelliing(t,n[2])}createSignatureSymbols(t){return[{type:"clef",clef:this.type}]}yRatioToPitch(t){let n=floor(t*this.rows.length),o=n<4?4:n>17?17:n;return this.pitches[o]}};var Nt=class extends it{type="percussion";clef=void 0;rows=["","","","","","","","","note","","","","","","","",""];get maxPitch(){return this.rows[17]}get bottomPitch(){return this.rows[8]}get centerPitch(){return this.rows[8]}get topPitch(){return this.rows[8]}parts={drums:{name:"drums",beam:"drums-beam",stemup:!1},cymbals:{name:"cymbals",beam:"cymbals-beam",stemup:!0}}};var ga=globalThis||window,Co=Object.assign,Tt=class extends S{type="piano";rows=["rh-A6 soprano-A6 alto-A6","rh-G6 soprano-G6 alto-G6","rh-F6 soprano-F6 alto-F6","rh-E6 soprano-E6 alto-E6","rh-D6 soprano-D6 alto-D6","rh-C6 soprano-C6 alto-C6","rh-B5 soprano-B5 alto-B5","rh-A5 soprano-A5 alto-A5","rh-G5 soprano-G5 alto-G5","rh-F5 soprano-F5 alto-F5","rh-E5 soprano-E5 alto-E5","rh-D5 soprano-D5 alto-D5","rh-C5 soprano-C5 alto-C5","rh-B4 soprano-B4 alto-B4","rh-A4 soprano-A4 alto-A4","rh-G4 soprano-G4 alto-G4","rh-F4 soprano-F4 alto-F4","rh-E4 soprano-E4 alto-E4","rh-D4 soprano-D4 alto-D4","rh-C4 soprano-C4 alto-C4","rh-B3 soprano-B3 alto-B3","lh-B4 rh-A3 soprano-A3 alto-A3 tenor-B4 bass-B4","lh-A4 rh-G3 soprano-G3 alto-G3 tenor-A4 bass-A4","lh-G4 rh-F3 soprano-F3 alto-F3 tenor-G4 bass-G4","lh-F4 rh-E3 soprano-E3 alto-E3 tenor-F4 bass-F4","lh-E4 rh-D3 soprano-D3 alto-D3 tenor-E4 bass-E4","lh-D4 tenor-D4 bass-D4","lh-C4 tenor-C4 bass-C4","lh-B3 tenor-B3 bass-B3","lh-A3 tenor-A3 bass-A3","lh-G3 tenor-G3 bass-G3","lh-F3 tenor-F3 bass-F3","lh-E3 tenor-E3 bass-E3","lh-D3 tenor-D3 bass-D3","lh-C3 tenor-C3 bass-C3","lh-B2 tenor-B2 bass-B2","lh-A2 tenor-A2 bass-A2","lh-G2 tenor-G2 bass-G2","lh-F2 tenor-F2 bass-F2","lh-E2 tenor-E2 bass-E2","lh-D2 tenor-D2 bass-D2","lh-C2 tenor-C2 bass-C2","lh-B1 tenor-B1 bass-B1","lh-A1 tenor-A1 bass-A1","lh-G1 tenor-G1 bass-G1","lh-F1 tenor-F1 bass-F1","lh-E1 tenor-E1 bass-E1"];getTimeSigHTML(t,n,o){return`<span class="timesig" data-event="${o}" data-part="rh">
            <sup>${N["timeSig"+t]}</sup>
            <sub>${N["timeSig"+n]}</sub>
        </span>
        <span class="timesig" data-event="${o}" data-part="lh">
            <sup>${N["timeSig"+t]}</sup>
            <sub>${N["timeSig"+n]}</sub>
        </span>`}staffs=["bass","treble"];parts=[{},{name:"lh",staff:"bass",topRow:29,centerRow:33,bottomRow:38},{name:"rh",staff:"treble",topRow:9,centerRow:13,bottomRow:18},{name:"soprano",staff:"treble",topRow:9,centerRow:13,bottomRow:18,stemup:!0},{name:"alto",staff:"treble",topRow:9,centerRow:13,bottomRow:18,stemup:!1},{name:"tenor",staff:"bass",topRow:29,centerRow:33,bottomRow:38,stemup:!0},{name:"bass",staff:"bass",topRow:29,centerRow:33,bottomRow:38,stemup:!1}];getRow(t,n){n=typeof n=="string"?n:J(n);let o=t.name+"-"+n.replace(ce,""),r=this.rows.findIndex(i=>i.includes(o));if(ga.DEBUG&&r===-1)throw new Error('Pitch "'+o+'" is not supported by '+this.constructor.name);return r===-1&&console.warn('Pitch "'+o+'" is not supported by '+this.constructor.name),r>-1?r:void 0}getPart(t){return typeof t=="number"?t<60?this.parts[1]:this.parts[2]:/[012]$|[AC-G][b#â™­â™¯ð„«ð„ª]*3$/.test(t)?this.parts[1]:this.parts[2]}createKeySymbols(t){let n=[],o=R(t),i=gt(o).map((a,c)=>a-q[c]&&{type:"acci",pitch:H(q[c])+ue[a-q[c]],value:a-q[c]}).filter(a=>!!a).sort(le);return n.push.apply(n,i.map(a=>Co({part:this.parts[1]},a))),n.push.apply(n,i.map(a=>Co({part:this.parts[2]},a))),n}createSignatureSymbols(t){return[{type:"clef",clef:"treble",part:this.parts[1],stave:this},{type:"clef",clef:"bass",part:this.parts[2],stave:this}].concat(this.createKeySymbols(t))}};var xn=class extends S{type="treble-up";clef=Ct;rows=["A7","G7","F7","E7","D7","C7","B6","A6","G6","F6","E6","D6","C6","B5","A5","G5","F5","E5","D5","C5","B4","A4","G4","F4","E4","D4","C4"]},wn=class extends S{type="treble";clef=Dt;rows=["A6","G6","F6","E6","D6","C6","B5","A5","G5","F5","E5","D5","C5","B4","A4","G4","F4","E4","D4","C4","B3","A3","G3","F3","E3","D3","C3"]},En=class extends S{type="treble-down";clef=St;rows=["A5","G5","F5","E5","D5","C5","B4","A4","G4","F4","E4","D4","C4","B3","A3","G3","F3","E3","D3","C3","B2","A2","G2","F2","E2","D2","C2"]},yn=class extends S{type="alto";clef=At;rows=["B5","A5","G5","F5","E5","D5","C5","B4","A4","G4","F4","E4","D4","C4","B3","A3","G3","F3","E3","D3","C3","B2","A2","G2","F2","E2","D2"]},bn=class extends S{type="bass";clef=Bt;rows=["C5","B4","A4","G4","F4","E4","D4","C4","B3","A3","G3","F3","E3","D3","C3","B2","A2","G2","F2","E2","D2","C2","B1","A1","G1","F1","E1"]};S.treble=wn;S["treble-up"]=xn;S["treble-down"]=En;S.alto=yn;S.bass=bn;S.piano=Tt;S.drum=it;S.percussion=Nt;S.create=e=>new S[e];var pe=S;var Q=1.1;function xa(e){return parseFloat(e.dataset.beat)}function wa(e){return parseFloat(e.dataset.duration)}function Ea(e){let t=e.childNodes;for(;t.length>1;)e.removeChild(e.lastChild)}function Ao(e,t,n,o,r){let i=n[0],a=n.length===1?o%(r*2)===0?t[i]:t[i]-.4*(t[i]-t[i-1]):t[i],c=n.length===1?o%(r*2)===0?t[i]+.5*(t[i+1]-t[i]):t[i]:t[n[n.length-1]];return`M${a}, ${-e*a-.5*Q}
        L${c},${-e*c-.5*Q}
        L${c},${-e*c+.5*Q}
        L${a}, ${-e*a+.5*Q}
        Z`}function vn(e,t,n,o,r,i,a){if(a<.0833)return;let c=r-1,s;for(;n[++c];)n[c]<=a?s?s.push(c):s=[c]:s&&(e.appendChild(b("path",{class:`beam-path-${4/a} beam-path`,d:Ao(i,o,s,t[c-1],a)})),vn(e,t,n,o,s[0],i,a/2),s=void 0);s&&(e.appendChild(b("path",{class:`beam-path-${4/a} beam-path`,d:Ao(i,o,s,t[c-1],a)})),vn(e,t,n,o,s[0],i,a/2),s=void 0)}function Dn(e){let t=e.dataset.beam,n=e.parentElement,o=Array.from(n.querySelectorAll('.top-note[data-beam="'+t+'"]')),r=o.map(xa),i=o.map(wa),a=e.viewBox.baseVal,c=a.y<-.5?a.y+.5:a.height-1,s=o.map(Fe),l=s[0].x,f=s[s.length-1].x,p=s.map(u=>(u.x-l)/(f-l));Ea(e),vn(e,r,i,p,0,-c,.25)}var Bo=B((e,t)=>t[1],{note:(e,t)=>(t[2]=D(t[2])+e,t),chord:(e,t)=>(t[2]=R(R(t[2])+e),t[5]!==void 0&&(t[5]=R(R(t[2])+e)),t),key:(e,t)=>(t[2]=R(R(t[2])+e),t),default:$});var ya={displace:(e,t,n)=>(n[0]-=e[++t],t),rate:(e,t,n)=>{switch(n[0]/=e[++t],n[1]){case"chord":case"note":case"sequence":n[4]/=e[t];break;case"text":n[3]/=e[t];break}return t},quantize:(e,t,n)=>{},transpose:(e,t,n)=>(Bo(e[t+1],n),t+1)};function kt(e,t){let n=-1,o;for(;o=e[++n];)n=ya[o](e,n,t);return t}var Ro=Object.assign,Fo=[],ba={done:!0,value:void 0},No={key:2,meter:1,default:0},va={};function To(e){return No[e[1]]||No.default}function Da(e,t){return t[0]<e[0]?1:t[0]>e[0]?-1:To(t)-To(e)}function Sa(e,t){return e.find(n=>n.id===t)}var Gt=class e{constructor(t,n=Fo,o=Fo){t.sort(Da),this.events=t,this.sequences=n,this.transforms=o;let r=-1,i;for(;(i=t[++r])&&kt(o,Ro(va,i))[0]<0;);this.n=r-1}next(){let{events:t,sequences:n,transforms:o,n:r}=this,i=t[r+1],a=i&&kt(o,dt.from(i,t,r+1)),c,s=-1,l=0,f=a?a[0]:1/0,p;for(;c=this[++s];){let u=c.value;u||((u=c.next().value)&&(kt(this.transforms,u),u[0]+=c.startBeat,u.target=(u.target||0)+c.target),(c.done||u[0]>=c.stopBeat)&&++l),u&&u[0]<c.stopBeat&&u[0]<f&&(p=c,f=u[0]),l&&(this[s]=this[s+l])}if(p)return this.value=p.value,p.value=void 0,this;if(!a)return Ro(this,ba);if(this.n+=1,this.value=a,dt.isSequenceEvent(i)){let u=this.sequences,d=Sa(u,i[2]);if(!d)throw new Error('Sequence id "'+i[2]+'" not found');let m=new e(d.events,d.sequences?d.sequences.concat(u):u,i.slice(5));m.startBeat=a[0],m.stopBeat=a[0]+a[4],m.target=a[3];let h=-1;for(;this[++h];);this[h]=m}return this}static from(t){return new e(t.events,t.sequences)}[Symbol.iterator](){return this}};function Ca(e,t,n){let o=e(t),r=e(n);return r===o?0:o>r?1:-1}var ko=V(Ca,!0);var{abs:Aa,EPSILON:Ba}=Math;function he(e,t){return Math.round(t/e)*e}function z(e,t,n=Ba){return e!==void 0&&(e===t||Aa(e-t)<n)}function st(e,t,n){return z(e,t,n)||e<t}function Ra(e,t,n){return z(e,t,n)||e>t}function xt(e,t,n){return e!==void 0&&t!==void 0&&!st(e,t,n)}function fe(e,t,n){return e!==void 0&&t!==void 0&&!Ra(e,t,n)}var{pow:Fa}=Math,Na=1/24,Ta=[2,3,4,5,6,7,9],ka=1/12,Go=.25,Po=.2,Sn={},wt=0;function Oo(e,t){return Math.cos(2*Math.PI*t/e)}function Mo(e,t,n,o,r){let i=e/t,a=0,c=0,s=0,l,f;for(o[r-1]&&xt(F(o[r-1]),n+.5*i,Na)&&(s=1),--r;o[++r]!==void 0&&o[r][0]-n<i/4;)s=1;for(--r;o[++r]!==void 0&&o[r][0]-n<e-i/4;){if(l=Math.round((o[r][0]-n)/i),f=1<<l,l<t&&f>s){if(t>4&&f>s<<1)return;s+=f}a+=Oo(i,o[r][0]-n),c+=1,!(o[r][0]+o[r][4]-n>e)&&(a+=Po*Oo(i,o[r][0]+o[r][4]-n),c+=Po)}if(!(t>4&&l!==t-1)&&c)return Sn.score=a/(c+1),Sn.rhythm=s,Sn}function Ga(e,t,n,o,r,i,a){let c=n[o-1]&&F(n[o-1])>r+.125?r:t*Math.floor((n[o][0]-r)/t)+r,s=i.length;for(;t/i[--s]<ka;);++s;let l,f;for(;l=i[--s];)f=Mo(t,l,c,n,o),f&&f.score>=wt&&f.score&&(wt=f.score,e.beat=c,e.duration=t,e.divisor=l,e.rhythm=f.rhythm),n[o][0]>=c+.5*t&&c+1.5*t<a&&(f=Mo(t,l,c+.5*t,n,o),f&&f.score>=wt&&(wt=f.score,e.beat=c+.5*t,e.duration=t,e.divisor=l,e.rhythm=f.rhythm));return e}function Lo(e,t,n){let o=-1;for(;e[++o]!==void 0&&e[o][0]<t;);if(!e[o])return;let r={};wt=Go;let i=1/8;for(;(i*=2)&&i<=n;)Ga(r,i,e,o,t,Ta,t+n);return wt>Go&&r}function qo(e,t){return t<Fa(2,e)-1}function Cn(e){return 2**Math.ceil(Math.log2(e))}function $o(e){return 2**Math.floor(Math.log2(e))}function An(e){return e>0&&(e&e-1)===0}function Bn(e,t,n){if(z(0,n,e/2))return t;let o=t*2;for(;(o/=2)>e;)if(z(0,mt(o,n),e/2))return o;return o}function Pt(e,t){let n=-1,o=0;for(;e[++n]!==void 0;);for(;arguments[++o]!==void 0;)e[n++]=arguments[o];return e}function Et(e){let t=-1;for(;e[++t]!==void 0;);return t}function Rn(e){return e[Et(e)-1]}function Fn(e,t){let n=[],o=-1;for(;t[++o]!==void 0;)n.push(e(t[o],o));return n}var K={spellChordRootCFlatAsB:!0,spellChordRootBSharpAsC:!0,spellChordRootESharpAsF:!0,spellChordRootFFlatAsE:!0,swingAsStraight8ths:!0,swingAsStraight16ths:!0,headDurations:[1/8,6/32,1/4,6/16,1/2,6/8,1,6/4,2,6/2,4,6,8],restDurations:[1/8,6/32,1/4,6/16,1/2,6/8,1,6/4,2,3,4,6,8]};var ge=Object.assign,{abs:dh,ceil:Pa,floor:me,min:Xo,max:Wo,pow:mh,sqrt:Ho,round:gh}=Math,I=1/16,Ot=1/24,Oa=ko(rt("row"));function Uo(e,t,n,o){return e+t/o.length}function jo(e,t){return Wo(e,F(t))}function Ma(e,t){return D(e[2])<D(t[2])?1:-1}function zo(e,t,n,o){if(!o.length)return[];let r=[],i=-1,a;for(;a=o[++i];){let p=a.scribeEvents,u=a.scribeIndex,d=se(p,u,t),m=ae(d),h=e.getSpelling(m,a),g=e.getRow(n,h);r.push({type:"note",pitch:h,part:n,row:g,stave:e,event:a})}r.sort(Oa),r[0].top=!0,r[r.length-1].bottom=!0;let c=r[0].row,s=r[r.length-1].row,l=n.stemup===void 0?Ko(e,n,c,s):n.stemup,f=0;for(i=-1;r[++i];)r[i].stemup=l,i>0&&r[i].row-r[i-1].row===1?r[i].clusterdown=++f:f=0;for(f=0,i=r.length-1;i--;)r[i+1].row-r[i].row===1?r[i].clusterup=++f:f=0;return r}function La(e,t,n){let o=-1,r=0,i,a;for(;n[++o];)a=e.getRow(t,n[o]),a!==void 0&&a>r&&(r=a,i=n[o]);return{row:r,pitch:i}}function qa(e,t,n){let o=-1,r=128,i,a;for(;n[++o];)a=e.getRow(t,n[o]),a!==void 0&&a<r&&(r=a,i=n[o]);return{row:r,pitch:i}}function Ko(e,t,n,o){let r=t.centerRow||e.centerRow,i=n-r;return o-r+i>0}function Vo(e,t,n){let{row:o}=La(e,t,n),{row:r}=qa(e,t,n);return Ko(e,t,o,r)}function $a(e,t,n){let o=[],r=-1,i;for(;i=n[++r];)i.type==="note"&&o.push(i.pitch);return Vo(e,t,o)}var Io=0;function _(e,t,n,o){let r=-1;for(;o[++r]&&o[r].beat===o.beat;);if(!o[r])return e;let i=o[0].beat,c=Rn(o).beat-i,s=n.stemup===void 0?Vo(t,n,Fn(rt("pitch"),o)):n.stemup;if(n.beam){let E;for(r=-1;E=o[++r];)E.stemup=s,E.beam=o;return e.push(ge(o,{duration:c,stemup:s,range:0,id:++Io})),e}let l=[],f;for(r=-1;f=o[++r];){let E=t.getRow(n,f.pitch);if(E===void 0)continue;let T;for(;o[++r]&&z(o[r].beat,f.beat,Ot);)T=t.getRow(n,o[r].pitch),T!==void 0&&(s?T<E&&(E=T):T>E&&(E=T));--r,l.push(E)}let p=l.length-1,u=l.slice(0,me(.5*l.length)).reduce(Uo,0),d=l.slice(Pa(.5*l.length)).reduce(Uo,0),m=Array.from(l,(E,T)=>(.2+.1*p)*T*(d-u)/p),h=m[m.length-1]-m[0],g=s?-50:50,x;for(r=l.length;r--;)x=m[r]-l[r],g=s?x>g?x:g:x<g?x:g;for(r=l.length;r--;)m[r]-=g+l[0];let w=-1;for(r=-1;f=o[++r];){for(++w,f.stemup=s,f.beam=o,f.stemHeight=s?1-.125*(m[r]-l[r]+l[0]):1+.125*(m[r]-l[r]+l[0]);o[++r]&&z(o[r].beat,f.beat,I);)o[r].stemup=s,o[r].beam=o,o[r].stemHeight=f.stemHeight;--r}return e.push(ge(o,{pitch:o[0].pitch,y:m[0],duration:c,stemup:s,range:h,id:++Io})),e}function de(e,t){let n=2*Cn(t);for(;(n/=2)>e/2;){if(1.75*n===t)return 1.75*n;if(1.5*n===t)return 1.5*n;if(n<=t)return n}return e}function Ha(e,t,n){n=n||1/0;let o=4*Cn(t);for(;(o/=2)>e/2;)if(o<=t*2&&o<=n)return o;return e}function Jo(e,t,n,o,r,i){let c=$o(t.divisor),s=me(r/t.divisor)*t.divisor,l=Bn(.125,c,r-s);if(i<o){if(e.indexOf(i-r)!==-1)return i-r;let p=me(i/t.divisor)*t.divisor;if(r===s){if(e.indexOf(p-r)!==-1)return p-r;let u=s+t.divisor<i&&s+t.divisor;return u?u-r:de(.125,i-r)}if(z(i,p,I)){let u=s+t.divisor<i&&s+t.divisor;return u&&e.indexOf(u-r)!==-1?u-r:l}}let f=me(o/t.divisor)*t.divisor;if(r===s){if(e.indexOf(o-r)!==-1)return o-r;if(e.indexOf(f-r)!==-1)return f-r;let p=s+t.divisor<o&&s+t.divisor;return p?p-r:Ha(.125,o-r,i-r)}else if(z(o,f,I)){if(e.indexOf(o-r)!==-1)return o-r;let p=s+t.divisor<o&&s+t.divisor;return p&&e.indexOf(p-r)!==-1?p-r:l}else{let p=4*l;return(r-s)%p/l===1?r+2*l===i?2*l:(r+3*l>=i&&console.log("Next event beat is inside quaduplet"),l<1?o>=r+l*3/2?3*l:o>=r+l?l:de(.125,o-r):o>=r+l*3?l*3:o>=r+l*2?l*2:o>r+l?l:de(.125,o-r)):o>r+l?l:de(.125,o-r)}}function Ua(e,t,n,o,r,i){return{type:"rest",beat:i,duration:Jo(e,t,i,r,i,r),stave:n,part:o}}function Nn(e,t,n,o,r,i,a){for(;xt(a,i,I);){let c=Ua(t,n,o,r,a,i);e.push(c),i+=c.duration}return a}function Ia(e,t,n,o,r){let{pitch:i,event:a}=o,c=Ft.test(i)?1:Rt.test(i)?-1:void 0,s=i[0]+i.slice(-1);if(c!==t[s])return t[s]=c,{type:"acci",beat:n,pitch:i,part:e,distance:r,value:c||0}}function Qo(e,t,n,o,r,i){let a=-1,c,s,l;for(;c=i[++a];)fe(c.event[0],t.beat,I)||(s=Ia(n,o,r,c,l!==void 0?c.row-l:void 0),s&&(console.log(t.beat+r,"ACCI",c.pitch,c.row,l!==void 0?c.row-l:void 0),l=c.row,e.push(s)))}function Zo(e,t,n,o,r){let i=r[0].row,a=r[0].pitch,c=i-(n.topRow||t.topRow)+1;c<0&&e.push({type:"ledge",beat:o,pitch:a,part:n,rows:c});let s=r[r.length-1].row,l=r[r.length-1].pitch;c=s-(n.bottomRow||t.bottomRow),c>0&&e.push({type:"ledge",beat:o,pitch:l,part:n,rows:c})}function Xa(e,t,n){let{beat:o,duration:r,divisor:i}=n,a=t.stemup===void 0?$a(e,t,n):t.stemup,c=-1,s;for(;s=n[++c];)s.type==="note"&&!s.beam&&(s.stemup=a);let l=o+.5*r,f=D(e.topPitch)-12,p,u=Et(n);for(;(s=n[--u])&&s.beat>l;);for(++u;(s=n[--u])&&s.beat+s.duration>l;){let w=D(s.pitch);(!p||w>p)&&(p=w)}let d=f;for(u=-1;(s=n[++u])&&s.beat<o+I;){let w=D(s.pitch);(!d||w>d)&&(d=w)}let m=f;for(u=Et(n);(s=n[--u])&&s.beat>o+r-r/i-I;){let w=D(s.pitch);(!m||w>m)&&(m=w)}let h=Math.ceil((d+m)/2),g=J(h);h>p&&(p=h),n.pitch=J(p),n.stemup=a;let x=m-d;n.angle=x<0?4*Ho(-x):-4*Ho(x)}function Wa(e,t,n,o,r,i,a,c,s,l,f,p,u,d,m){(c.swingAsStraight8ths&&l===1||c.swingAsStraight16ths&&l===.5)&&f===3&&(p===4||p===5)&&(f=2);let h=l/f,g=s+l,x={type:"tuplet",beat:s,duration:l,divisor:f,rhythm:p,part:i,stave:n},w;for(An(f)||e.push(x);fe(s,g,Ot);){for(;(w=d[++m])&&st(w[0]-t.beat,s+.5*h,Ot);)u.push(w);if(--m,!u.length){e.push({type:"rest",beat:s,duration:h,stave:n,part:i}),s+=h;continue}let E=zo(n,o,i,u);Zo(e,n,i,s,E),Qo(e,t,i,r,s,E);let T=Xo(u.reduce(jo,0)-t.beat,w?w[0]-t.beat:t.duration,x.beat+x.duration),C=Wo(h,he(h,T-s)),A=-1;for(;E[++A];)e.push(ge(E[A],{beat:s,duration:C}));for(Pt(x,...E),xt(C,.5,Ot)?a&&(_(e,n,i,a),a=void 0):a||(a={type:"beam",beat:s,part:i}),a&&Pt(a,...E),A=u.length;A--;){let U=F(u[A])-t.beat;st(U,s+C+.5*h,Ot)?u.splice(A,1):e.push({type:"tie",beat:s,pitch:E[A].pitch,duration:C,stemup:E[A].stemup,part:i,event:u[A]})}s+=C}return a&&_(e,n,i,a),Xa(n,i,x),m}function Tn(e,t,n,o=0,r={},i,a,c=K){let s=[],{headDurations:l,restDurations:f}=c,p=0,u=-1,d,m,h;for(;(d=a[++u])&&st(d[0]+d[4]-t.beat,p,I););for(--u;fe(p,t.duration,I);){h&&t.divisions.find(U=>z(p,U,I))&&(_(e,n,i,h),h=void 0);let g=Lo(a,t.beat+p,t.duration-p);if(g&&!An(g.divisor)){xt(g.beat-t.beat,p,I)&&Nn(e,c.restDurations,t,n,i,p,g.beat-t.beat),h&&qo(g.divisor,g.rhythm)&&(_(e,n,i,h),h=void 0),u=Wa(e,t,n,o,r,i,h,c,g.beat-t.beat,g.duration,g.divisor,g.rhythm,s,a,u),p=g.beat-t.beat+g.duration;continue}for(;(d=a[++u])&&st(d[0]-t.beat,p,I);)s.push(d);if(--u,n.pitched&&s.sort(Ma),!s.length){if(!d){h&&(_(e,n,i,h),h=void 0),Nn(e,c.restDurations,t,n,i,p,t.duration);break}let U=he(.125,d[0]-t.beat);if(U<=p){console.log(`Problem at bar ${t.count}, moving to next bar ${p} ${U}`),t.error="Stop beat has ended up less than beat";break}h&&(Yo(t.divisions,p,U)||U-p>=.5)&&(_(e,n,i,h),h=void 0),Nn(e,f,t,n,i,p,U),p=U;continue}let x=zo(n,o,i,s);Zo(e,n,i,p,x),Qo(e,t,i,r,p,x);let w=s[0][0]-t.beat,E=Xo(t.duration,s.reduce(jo,0)-t.beat),T=d&&he(.125,d[0])-t.beat,C=Jo(l,t,w,E,p,T),A=-1;for(;x[++A];)e.push(ge(x[A],{beat:p,duration:C}));for(C>=1?h&&(_(e,n,i,h),h=void 0):h||(h={type:"beam",beat:p,part:i}),h&&Pt(h,...x),A=s.length;A--;){let U=F(s[A])-t.beat;st(U,p+C,I)||U-(p+C)<.125+1/16*(F(s[A])-s[A][0])?s.splice(A,1):e.push({type:"tie",beat:p,pitch:x[A].pitch,duration:C,stemup:x[A].stemup,part:i,event:s[A]})}p+=C}return h&&_(e,n,i,h),e}var ja={"2,2":[2],"3,2":[2,4],"2,1":[1],"3,1":[1,2],"4,1":[2],"3,0.5":[1.5],"3,1.5":[1.5],"12,0.5":[1.5,3,4.5]};function za(e,t){return ja[e+","+t]||ee}function Yo(e,t,n){let o=-1;for(;e[++o]&&e[o]<=t;);return n>e[o]?e[o]:void 0}var Ka=[];function _o(e,t){return gt(t).reduce((o,r,i)=>{let a=r-q[i];if(a!==0){let c=H(q[i]),s=10;for(;s--;)o[c+s]=a}return o},e),e}function Va(e,t,n,o,r,i,a){let c=-1,s;for(;s=i[++c];)switch(s[1]){case"key":{let l=R(s[2]);_o(r,l),t.key=l;break}case"meter":{e.push({type:"timesig",beat:0,numerator:s[3]===1.5?s[2]/.5:s[2]/s[3],denominator:s[3]===1.5?8:4/s[3],stave:n,event:s});break}case"symbol":{e.push({type:"symbol"+s[2],stave:n});break}case"chord":{let l=s[0]-t.beat,f=se(i,c,o),p=ae(f),u=n.getSpelling(p,s);u==="Câ™­"&&a.spellChordRootCFlatAsB&&(u="B"),u==="Eâ™¯"&&a.spellChordRootESharpAsF&&(u="F"),u==="Bâ™¯"&&a.spellChordRootBSharpAsC&&(u="C"),u==="Fâ™­"&&a.spellChordRootFFlatAsE&&(u="E"),e.push({type:"chord",beat:l,duration:s[0]+s[4]>t.beat+t.duration?t.duration-l:s[4],root:u,extension:s[3],event:s,stave:n});break}case"text":{let l=s[0]-t.beat;e.push({type:"text",beat:l,duration:s[0]+s[3]>t.beat+t.duration?t.duration-l:s[3],value:s[2],event:s,stave:n});break}case"sequence":{t.doubleBarLine=!0;break}default:{if(Ka.includes(s[1]))return;console.log('Scribe: ignoring event type "'+s[1]+'"')}}return e}function Mt(e,t,n,o,r,i,a,c,s,l=K){let f=[];if(s){let x=F(s);x>t&&x<=t+n&&a.push(s)}let p=_o({},i),u={type:"bar",beat:t,duration:n,key:i,divisor:o||4,divisions:za(n,o),stave:r,count:e,symbols:f};Va(f,u,r,i,p,a,K);let d,m=0,h=r.staffs?r.staffs.slice():[];for(d in r.parts){let x=r.parts[d],w=c[x.name]||[];if(!w.length)continue;let E=h.indexOf(x.staff);E&&h.splice(E,1),Tn(f,u,r,i,p,x,w,l),++m}let g=h.length;for(;g--;)console.log("Stave has not rendered onto staff, render rests"),Tn(f,u,r,i,p,r.parts[g+1],[],l);return u}function Ja(e,t){if(!(e==="stave"||e==="event"||e==="sequence"||e==="beam"))return t}function Qa(e){let t=e.symbols.filter(n=>n.type==="chord"||n.type==="note");return JSON.stringify(t,Ja)}function at(e,t){e.symbols=e.symbols.filter(n=>n.type==="doublebarline"||n.type==="clef").concat([{type:"barrepeat",count:t,duration:e.duration}])}function xe(e,t,n){let o=Qa(n);switch(t.length){case 1:break;case 2:break;case 3:{o==="[]"&&t[0]==="[]"?t.length=0:o===t[0]&&o===t[1]&&o===t[2]&&n.symbols.filter(r=>r.type!=="clef"&&r.type!=="timesig").find(r=>r.type!=="rest")?(at(e[e.length-2],1),at(e[e.length-1],1),at(n,1)):(o!==t[1]||t[0]!==t[2])&&(t.length=2);break}case 4:{o===t[0]&&o===t[1]&&o===t[2]&&o===t[3]?(at(n,1),t.length=3):(o!==t[1]||t[0]!==t[2]||o!==t[3])&&(t.length=2);break}case 5:{o===t[1]&&o===t[3]&&t[0]===t[2]&&t[0]===t[4]?(e.length-=2,at(e[e.length-1],2),at(n,2)):t.length=4;break}case 6:break;case 7:{o===t[1]&&o===t[3]&&t[0]===t[2]&&t[0]===t[4]?(e.length-=1,at(n,2),t.length=5):t.length=1;break}}for(t.unshift(o);t.length>8;)t.pop()}function kn(e,t,n){let o=n.target?e.parts[n.target]:e.getPart(n[2]),r=t[o.name]||(t[o.name]=[]);t[o.name].push(n)}function Gn(e,t,n,o=K){let r=[],i=[],a=[],c=[],s=0,l=[],f={},p=0,u=0,d,m,h,g;for(h of e)if(h.scribeIndex=r.length,h.scribeEvents=r,r.push(h),!t.includes(h[1])){for(;h[0]>=s+d;){let w=Mt(i.length+1,s,d,m,n,p,l,f,g,o);xe(i,c,w),i.push(w),p=w.key,s=s+d,l=[],f={};let E=-1;for(;a[++E];)kn(n,f,a[E]),F(a[E])<s+d&&a.splice(E--,1)}switch(h[1]){case"note":{kn(n,f,h),F(h)>s+d&&a.push(h),u<F(h)&&(u=F(h));break}case"sequence":{h.events===e.events&&(g=h),u<F(h)&&(u=F(h));break}case"meter":d=h[2],m=h[3],h[0]!==s&&console.log("TODO");default:l.push(h)}}for(;a.length;){let w=Mt(i.length+1,s,d,m,n,p,l,f,g,o);xe(i,c,w),i.push(w),s=s+d,l=[],f={};let E=-1;for(;h=a[++E];)kn(n,f,h),F(h)<s+d&&a.splice(E--,1)}for(;s<u-d;){let w=Mt(i.length+1,s,d,m,n,p,l,f,g,o);xe(i,c,w),i.push(w),s=s+d,l=[],f={}}d||(d=F(r[r.length-1]));let x=Mt(i.length+1,s,d,m,n,p,l,f,g,o);return xe(i,c,x),i.push(x),i}var we=Symbol("scribe-id"),Za=0;function ct(e){return e[we]||(e[we]=++Za+""),e[we]}var Ee=Math.abs,ye={flat:`<span class="chord-flat">${Yt}</span>`,sharp:`<span class="chord-sharp">${te}</span>`},Ya={2:"acci acci-doublesharp",1:"acci acci-sharp",0:"acci acci-natural","-1":"acci acci-flat","-2":"acci acci-doubleflat"},_a={2:_e,1:te,0:_t,"-1":Yt,"-2":Ye},tc={treble:Dt,"treble-down":St,"treble-up":Ct,alto:At,bass:Bt,drum:Zt,percussion:Zt},ec={"1.33":an,"0.67":sn,"0.33":rn,"0.17":on,"0.08":nn},nc=/^(âˆ†|-|Ã¸|7|\+)?(alt|sus|maj|min|dim|aug)?(.*)$/;function O(e){return e.toFixed(4).replace(/\.?0+$/,"")}var Pn=B(rt("type"),{barrepeat:e=>b("span",{class:"barrepeat",html:N["barRepeat"+e.count],data:{duration:e.duration}}),clef:e=>b("span",{class:`${e.clef}-clef clef`,html:tc[e.clef]}),chord:e=>{let t=nc.exec(e.extension);return b("abbr",{class:"chord chord-abbr",title:"",html:'<span class="chord-root">'+e.root.replace(Ft,ye.sharp).replace(Rt,ye.flat)+'</span><span class="chord-ext">'+(t[1]?'<span class="chord-ext-'+t[1]+'">'+t[1]+"</span>":"")+(t[2]?"<sub>"+t[2]+"</sub>":"")+(t[3]?"<sup>"+t[3].replace(Ft,ye.sharp).replace(Rt,ye.flat)+"</sup>":"")+"</span>"+(e.bass?un+'<span class="chord-bass">'+e.bass+"</span>":""),data:{beat:O(e.beat),duration:O(e.duration),event:ct(e.event)}})},timesig:e=>e.stave.getTimeSigHTML?b("fragment",e.stave.getTimeSigHTML(e.numerator,e.denominator,ct(e.event))):b("span",{class:"timesig",html:`<sup>${N["timeSig"+e.numerator]}</sup>
                <sub>${N["timeSig"+e.denominator]}</sub>`,data:{event:ct(e.event)}}),symbolcoda:e=>b("p",{html:cn,class:"coda"}),barcount:e=>b("span",{html:e.text,class:"barcount"}),text:e=>b("span",{class:"lyric",part:"lyric",html:e.value,data:{beat:O(e.beat),duration:O(e.duration),event:ct(e.event)}}),acci:e=>b("span",{class:(Ya[e.value]||"acci")+(e.distance<6?" cluster-acci":""),html:_a[e.value]||_t,data:{beat:e.beat&&O(e.beat),pitch:e.pitch,part:e.part.name,event:e.event&&ct(e.event)}}),ledge:e=>b("svg",{class:`${e.rows<0?"up":"down"}-ledge ledge`,viewBox:e.rows<0?`0 ${9+e.rows-.5} 5 ${Ee(e.rows)}`:`0 -0.5 5 ${Ee(e.rows)}`,preserveAspectRatio:"xMidYMin",html:`
            <line x1="0" x2="5" y1="0" y2="0"></line>
            <line x1="0" x2="5" y1="2" y2="2"></line>
            <line x1="0" x2="5" y1="4" y2="4"></line>
            <line x1="0" x2="5" y1="6" y2="6"></line>
            <line x1="0" x2="5" y1="8" y2="8"></line>
        `,data:{beat:O(e.beat),pitch:e.pitch,part:e.part.name}}),note:e=>b("data",{class:`${e.stemup?"up-note ":"down-note "}${e.top?"top-note ":""}${e.bottom?"bottom-note ":""}${e.stemup?e.clusterup%2===1?"cluster-note ":"":e.clusterdown%2===1?"cluster-note ":""}${e.beam?"beam-note ":""}note`,style:e.stemHeight?`--stem-height: ${e.stemHeight};`:void 0,html:e.stave.getNoteHTML(e.pitch,e.dynamic,e.duration),title:`${e.pitch} (${D(e.pitch)})`,data:{beat:O(e.beat),pitch:e.pitch,duration:O(e.duration),part:e.part.name,beam:e.beam&&e.beam.id,event:ct(e.event)}}),beam:(e,t)=>b("svg",{class:`${e.stemup?"up":"down"}-beam beam`,viewBox:`0 ${(e.range<0?e.range:0)-.5} 1 ${Ee(e.range)+1}`,preserveAspectRatio:"none",style:`--duration: ${O(e.duration)}; ${e.y?"--translate-y:"+e.y*.125+";":""} height: ${(Ee(e.range)+Q)*.125}em; align-self: ${e.range<0?"end":"start"};`,html:`<path class="beam-path" d="M0,${-.5*Q} L1,${e.range-.5*Q} L1,${e.range+.5*Q} L0,${.5*Q} Z"></path>`,data:{beat:O(e.beat),pitch:e.pitch,part:e.part.name,beam:e.id}}),tie:e=>b("svg",{class:`${e.stemup?"down":"up"}-tie tie`,viewBox:"0 0 1 1",preserveAspectRatio:"none",html:'<path class="tie-path" transform="translate(0, 0.14) scale(1 0.6)" d="M0.979174733,0.0124875307 C0.650597814,1.1195554 0.135029714,1.00095361 0.0165376402,0.026468657 C0.0113570514,0.0135475362 0.00253387291,0.00218807553 0,0 C0.0977526897,1.29523004 0.656681642,1.37089992 1,2.43111793e-08 C0.991901367,2.43111797e-08 0.987703936,0.01248753 0.979174733,0.0124875307 Z M0.979174733,0.0124875307"></path>',data:{beat:O(e.beat),pitch:e.pitch,duration:O(e.duration),part:e.part.name}}),tuplet:e=>b("span",{class:`${e.stemup?"up":"down"}-tuplet tuplet`,html:N["tuplet"+e.divisor],data:{beat:O(e.beat),pitch:e.pitch,duration:O(e.duration),divisor:e.divisor,rhythm:e.rhythm.toString(2).split("").reverse().join(""),part:e.part.name},style:`--angle: ${e.angle}deg;`}),rest:e=>b("span",{class:"rest",html:ec[e.duration.toFixed(2)]||N["rest"+(e.duration+"").replace(".","")]||"",data:{beat:O(e.beat),pitch:e.pitch,duration:O(e.duration),part:e.part.name},"aria-hidden":"true"}),default:function(e){return function(t){e[t.type]||(e[t.type]=!0,console.log(t),console.error('Scribe: symbol type "'+t.type+'" not rendered'))}}({})});function oc(e){return e[0]<=0&&e[1]==="meter"}function rc(e){return e[0]<=0&&e[1]==="key"}function ic(e,t){let n=Pn(t);return n&&e.push(n),e}function sc(e,t){return e.push(b("div",{class:`${t.stave.type}-stave stave ${t.doubleBarLine?"end-bar ":""}bar${t.error?" error ":""}`,data:{beat:t.beat,duration:t.duration,count:t.count,key:H(t.key)},children:t.symbols.reduce(ic,[])})),e}function On(e,t,n,o,r,i=1/0,a=0,c=0,s=K){let l=e.events;!l.find(oc)&&r&&l.unshift([0,"meter",r[2],r[3]]),!l.find(rc)&&o&&l.unshift([0,"key",o]);let u=pe.create(n||"treble"),d=[];a&&d.push("transpose",a),c&&d.push("displace",c);let m=new Gt(l,e.sequences,d),h=Gn(m,t,u,s),g=h.reduce(sc,[]),w=h[0].key,E=u.createSignatureSymbols(w),T=b("div",{class:`${u.type}-stave signature-stave stave`,children:E.map(Pn),data:{key:H(w)}}),C=b("div",{id:"side",class:"side",data:{key:H(w)}}),A=24;for(;A--;)C.appendChild(T.cloneNode(!0));return g.unshift(C),g}var tr=Object.assign,ac=Object.defineProperties,cc=new URL("shadow.css",import.meta.url),be=v.of(),uc=[],er=new ResizeObserver(e=>{for(let t of e)y(t.target).shadowRoot.querySelectorAll(".beam").forEach(Dn)}),Gf=ac(Me("scribe-music",{shadow:`
        <link rel="stylesheet" href="${cc}" />
    `,construct:function(e,t){let n=e.querySelector("link");uc.push(o=>n.href=o),be.value&&(n.href=be.value),t.data=v.of(),t.clef=v.of("treble"),t.key=v.of("C"),t.meter=v.of(),t.beat=v.of(0),t.duration=v.of(1/0),t.transpose=v.of(0),t.excludes=v.of([]),t.swingAsStraight8ths=v.of(!1),t.swingAsStraight16ths=v.of(!1),t.debug=v.of(!1),t.isSafari=navigator.userAgent.includes("AppleWebKit/")&&!navigator.userAgent.includes("Chrome/")&&!navigator.userAgent.includes("Edge/")&&!navigator.userAgent.includes("Gecko/")},connect:function(e,t){if(t.isSafari&&this.classList.add("safari"),er.observe(this,{box:"content-box"}),!this.src){let n=this.textContent.trim();t.data.value=ot(this.type,n)}return v.frame(()=>{let n=t.data.value&&On(t.data.value,t.excludes.value,t.clef.value,t.key.value,t.meter.value,t.duration.value,t.transpose.value,t.beat.value,tr({},K,{swingAsStraight8ths:t.swingAsStraight8ths.value,swingAsStraight16ths:t.swingAsStraight16ths.value}));if(e.querySelectorAll(".side, .bar, style").forEach(s=>s.remove()),e.append.apply(e,n),!n)return;let r=e.getElementById("side").dataset.key,a={"Gâ™­":6,"Câ™¯":5,"Dâ™­":5,"Gâ™¯":4,"Aâ™­":4,"Dâ™¯":3,"Eâ™­":3,"Bâ™­":2,F:1,C:0,G:1,D:2,A:3,E:4,B:5,"Fâ™¯":6}[r],c=b("style",":host { --signature-width: "+(2.25+a*.625+.625).toFixed(4)+"em; }");e.appendChild(c),e.querySelectorAll(".beam").forEach(Dn),t.debug.value&&e.querySelectorAll(".bar").forEach(s=>{let l=parseFloat(s.dataset.duration),f=0,p,u;s.querySelector(".barrepeat")||(s.querySelectorAll(".rest[data-duration], .note[data-duration]").forEach(d=>{p!==parseFloat(d.dataset.beat)&&(p=parseFloat(d.dataset.beat),u=parseFloat(d.dataset.duration),f+=u)}),Math.round(f/.0625)!==Math.round(l/.0625)&&s.classList.add("error"))})})},disconnect:function(){er.unobserve(this)}},{clef:{attribute:function(e){this.clef=e},get:function(){return y(this).clef.value},set:function(e){if(!pe[e]){console.warn('<scribe-music> Attempt to set invalid clef="'+e+'" ignored');return}y(this).clef.value=e}},key:{attribute:function(e){this.key=e===""?"C":e},get:function(){return y(this).key.value},set:function(e){let t=y(this);if(typeof e!="string"||!/^[A-G][#bâ™¯â™­]?$/.test(e)){console.warn('<scribe-music> Attempt to set invalid key="'+e+'" ignored');return}t.key.value=e.replace(/[#b]$/,n=>n==="#"?"â™¯":"â™­")}},meter:{attribute:function(e){this.meter=e===""?"4/4":e},get:function(){return ho(y(this).meter.value)},set:function(e){y(this).meter.value=tr([0],po(e))}},beat:{attribute:function(e){this.beat=e},get:function(){return y(this).beat.value},set:function(e){y(this).beat.value=typeof e=="number"?e:parseFloat(e)}},duration:{attribute:function(e){this.duration=e},get:function(){return y(this).duration.value},set:function(e){y(this).duration.value=typeof e=="number"?e:parseFloat(e)}},transpose:{attribute:function(e){this.transpose=e},get:function(){return y(this).transpose.value},set:function(e){y(this).transpose.value=typeof e=="number"?Math.round(e):parseInt(e,10)}},type:{attribute:function(e){this.type=e},writable:!0,value:"application/json"},src:{attribute:function(e){this.src=e},get:function(){return y(this).src},set:function(e){let t=y(this);t.src=e;let n=new URL(e,window.location);if(window.location.origin===n.origin&&window.location.pathname===n.pathname){let o=this.getRootNode().getElementById(n.hash.slice(1));if(!o)throw new Error('<scribe-music> src script "'+e+'" not found in document');this.data=JSON.parse(o.textContent)}else lo(this.type,n.href).then(o=>this.data=o)},default:null},data:{get:function(){return y(this).data.value},set:function(e){y(this).data.value=e},default:null},swing:{attribute:function(e){y(this).swingAsStraight8ths.value=e!==null}},shuffle:{attribute:function(e){y(this).swingAsStraight16ths.value=e!==null}},debug:{attribute:function(e){this.debug=e!==null},get:function(){return y(this).debug.value},set:function(e){y(this).debug.value=!!e}},excludes:{attribute:function(e){return y(this).excludes.value=e.split(/\s+/)}}},null,"github.com/stephband/scribe/"),{stylesheet:{set:e=>be.value=e,get:()=>be.value}});export{Gf as default};
//# sourceMappingURL=element.js.map

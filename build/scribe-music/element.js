/* Scribe 
   0.4.5
   By Stephen */

import{a as B,b as E,c as Et,d as G,e as D,f as T,g as Tt,h as St,i as Y,j as qt}from"../modules/chunk-36GOCXTA.js";var f,A;function Zt(e,t){let n=-1;for(;e[++n]&&e[n]!==t;);for(;e[n++];)e[n-1]=e[n]}function rt(e){let t=0;for(;e[--t];)e[t].stop&&e[t].stop(),e[t]=void 0}function L(e,t){let n=0;for(;t[--n]&&t[n]!==e;);for(t[n]=e,n=-1;e[++n]&&e[n]!==t;);e[n]=t}function O(e){let t=-1,n;for(;n=e[++t];)e[t]=void 0,n.invalidate(e)}function st(e,t){let n=0;for(;e[--n];)if(e[n]===t)return!0}var u=class e{static isSignal(t){return t instanceof e}static of(t){return new Z(t)}static from(t,n){if(t.then){let r=e.of();return t.then(s=>r.value=s),r}return t.pipe?t.pipe(new _):new M(t,n)}static compute(t,n){return new M(t,n)}static fromProperty(t,n){return new tt(t,n)}static frame(t){return new N(t)}static tick(t){return new P(t)}static temporal(t,n){return new et(t,n)}static evaluate(t,n,r=t){let s=f;f=t,s||(A=!1);let a=n.apply(r);return f=s,a}static get hasInvalidDependency(){return A}static get evaluating(){return f}constructor(t){t&&(this.name=t)}valueOf(){return this.value}toString(){return this.value+""}toJSON(){return this.value}},Z=class extends u{#t;constructor(t){super(),this.#t=t}get value(){return f&&L(this,f),this.#t}set value(t){this.#t!==t&&(this.#t=t,O(this))}},_=class extends u{#t;constructor(t){super(),this.#t=t}get value(){return f&&L(this,f),this.#t}push(t){this.#t!==t&&(this.#t=t,O(this))}},tt=class extends u{#t;#e;constructor(t,n){super(t),this.object=n}evaluate(){return this.object[this.name]}get value(){return f&&L(this,f),this.#t?this.#e:(this.#e=u.evaluate(this,this.evaluate,this),A||(this.#t=!0),this.#e)}set value(t){if(this.#e===t)return;let{object:n,name:r}=this;n[r]=t,t=n[r],this.#e!==t&&(this.#e=t,O(this))}invalidate(t){this.#t&&(t&&!st(this,t)||(this.#t=!1,rt(this),O(this)))}},M=class extends u{#t;#e;#n;#r;constructor(t,n){super(),this.#t=t,this.#e=n}get value(){return f&&L(this,f),this.#n?this.#r:(this.#r=u.evaluate(this,this.#t,this.#e),A||(this.#n=!0),this.#r)}invalidate(t){this.#n&&(t&&!st(this,t)||(this.#n=!1,rt(this),O(this)))}},et=class extends u{#t=0;constructor(t,n){super(t),this.object=n}getTime(){return window.performance.now()}evaluate(){return this.object[this.name]}get value(){return u.evaluating&&(L(this,f),this.getTime()<this.#t&&(A=!0)),this.evaluate()}set value(t){console.warn("Dont really want to be setting value of TimedSignal"),console.trace(),this.object[this.name]!==t&&(this.object[this.name]=t,invalidateUntil(this.getTime()))}invalidateUntil(t){let r=this.getTime()>=this.#t;this.#t=t,r&&O(this)}},I=class extends u{constructor(t){if(super(),f){let n=0;for(;f[--n]&&f[n]!==this;);f[n]=this}t&&(this.evaluate=t,(u.evaluate(this,this.evaluate)||A)&&this.cue())}invalidate(t){this.constructor.observers.indexOf(this)===-1&&(t&&!st(this,t)||(rt(this),this.cue()))}stop(){let t=0,n;for(;n=this[--t];){let a=-1;this[t]=void 0,n.stop?n.stop():Zt(n,this)}let r=this.constructor.observers,s=r.indexOf(this);if(s!==-1){if(r===nt)throw new Error("Attempt to remove observer while observers is rendering");r.splice(s,1)}return this}valueOf(){return this}toString(){return"[object Signal]"}toJSON(){}},nt;function At(e){let t=-1,n;for(nt=e;n=e[++t];)!u.evaluate(n,n.evaluate)&&!A&&e.splice(t--,1);return nt=void 0,e}var kt=Promise.resolve();function jt(){At(P.observers).length&&kt.then(jt)}var P=class extends I{static observers=[];cue(){let t=this.constructor.observers;t.length||kt.then(jt),t.push(this)}};function Dt(){At(N.observers).length&&requestAnimationFrame(Dt)}var N=class extends I{static observers=[];cue(){let t=this.constructor.observers;t.length||window.requestAnimationFrame(Dt),t.push(this)}};function it(e,t,n){let r;typeof n!="string"&&n.input!==void 0&&n.index!==void 0&&(r=n,n=r.input.slice(n.index+n[0].length+(n.consumed||0)));let s=e.exec(n);if(!s)return;let a=t(s);return r&&(r.consumed=(r.consumed||0)+s.index+s[0].length+(s.consumed||0)),a}var Pe=G(it,!0);function _t(e,t,n){throw n.input!==void 0&&n.index!==void 0&&(n=n.input),new Error('Cannot parse string "'+(n.length>128?n.length.slice(0,128)+"…":n)+'"')}function te(e,t,n){let r=-1;for(;++r<n.length;)t=n[r]!==void 0&&e[r]?e[r](t,n):t;return e.done?e.done(t,n):e.close?e.close(t,n):t}function ee(e,t,n,r){let s=it(e,a=>te(t,n,a),r);return s===void 0?t.catch?t.catch(n,r):_t(e,t,r):s}var Ot=G(ee,!0);var Rt=Symbol("internals");function ot(e,t,n){return t[Rt]=t.attachInternals&&!t.getAttribute("is")?t.attachInternals():{shadowRoot:n}}function o(e){return e[Rt]}var Ct=Object.defineProperties;var at={},ne={name:{set:function(e){return this.setAttribute("name",e)},get:function(){return this.getAttribute("name")||""}},form:{get:function(){return o(this).form}},labels:{get:function(){return o(this).labels}},validity:{get:function(){return o(this).validity}},validationMessage:{get:function(){return o(this).validationMessage}},willValidate:{get:function(){return o(this).willValidate}},checkValidity:{value:function(){return o(this).checkValidity()}},reportValidity:{value:function(){return o(this).reportValidity()}}},ut=!1,re=Ot(/^\s*<?([a-z][\w]*-[\w-]+)>?\s*$|^\s*<?([a-z][\w]*)\s+is[=\s]*["']?([a-z][\w]*-[\w-]+)["']?>?\s*$/,{1:(e,t)=>({name:t[1]}),2:(e,t)=>({name:t[3],tag:t[2]}),catch:function(e,t){throw new SyntaxError(`dom element() – name must be of the form 'element-name' or 'tag is="element-name"' (`+t+")")}},null),Bt={once:!0};function se(e){return e.sheet?Promise.resolve({target:e}):new Promise((t,n)=>{e.addEventListener("load",t,Bt),e.addEventListener("error",n,Bt)})}function ie(e){e.stop()}function oe(e){if(at[e])return at[e];let t=document.createElement(e).constructor;if(t===HTMLUnknownElement)throw new Error("Cannot define customised built-in - constructor for <"+e+"> is HTMLUnknownElement");return at[e]=t}function ae(e,t){if(e.hasOwnProperty(t)){let n=e[t];delete e[t],e[t]=n}return e}function Lt(e,t){let n=e.attachShadow({mode:t.mode||"closed",delegatesFocus:t.focusable||!1});if(t.stylesheet){let r=T("link",{rel:"stylesheet",href:t.stylesheet});n.append(r)}return n}function ue(e,t){return typeof t=="string"?t[0]==="#"?e.appendChild(document.getElementById(t.slice(1)).content.clone(!0)):e.innerHTML=t:e.appendChild(t.content.clone(!0)),e}function ce(e){let t=e.isUpgraded;return e.isUpgraded=!0,!t}function Ut(e,t){return Array.from(e.querySelectorAll('[is="'+t+'"]')).filter(ce)}var le=E((e,t)=>typeof t,{object:(e,t)=>t,function:(e,t)=>({value:t}),default:(e,t)=>{throw new TypeError("element() does not accept property descriptor of type "+typeof t)}});function ct(e,t={},n={},r=""){let{name:s,tag:a}=re(e),v=typeof a=="string"?oe(a):HTMLElement,m=[],w={},b,g;for(b in n)g=le(b,n[b]),g.attribute&&m.push(b),(g.set||g.get||"value"in g)&&(w[b]=g),n[b]=g;function c(){let i=Reflect.construct(v,arguments,c),l=t.mode||typeof t.shadow=="string"?Lt(i,t):void 0;t.shadow&&ue(l,t.shadow);let y=ot(c,i,l);return a&&(ut=!0),t.construct&&t.construct.call(i,l,y),Object.keys(w).reduce(ae,i),i}if(c.prototype=Object.create(v.prototype,w),n.value&&(c.formAssociated=!0,Ct(c.prototype,ne),(t.enable||t.disable)&&(c.prototype.formDisabledCallback=function(i){let l=o(this);return i?t.disable&&t.disable.call(this,l.shadowRoot,l):t.enable&&t.enable.call(this,l.shadowRoot,l)}),t.reset&&(c.prototype.formResetCallback=function(){let i=o(this);return t.reset.call(this,i.shadowRoot,i)}),t.restore&&(c.prototype.formStateRestoreCallback=function(){let i=o(this);return t.restore.call(this,i.shadowRoot,i)})),m.length&&(c.observedAttributes=m,c.prototype.attributeChangedCallback=function(i,l,y){return n[i].attribute.call(this,y)}),t.connect&&(c.prototype.connectedCallback=function(){let i=o(this),l=i.shadowRoot;if(i.stopable=t.connect.call(this,l,i),!l)return;let y=l.querySelectorAll('link[rel="stylesheet"]');if(y.length){let h=T("style","*:not(slot), slot:not([name]) { display: none !important; }");l.prepend(h);let S;i.loadPromise?S=i.loadPromise.then(()=>new Promise(requestAnimationFrame)):S=i.loadPromise=Promise.all(Array.from(y,se)),S.finally(()=>{h.remove(),t.load&&t.load.call(this,l,i)})}else t.load&&t.load.call(this,l,i)}),c.prototype.disconnectedCallback=function(){let i=o(this);i.stopable&&(i.stopable.stop?i.stopable.stop():i.stopable.forEach(ie)),t.disconnect&&t.disconnect.call(this,i.shadowRoot,i)},window.console&&window.console.log("%c<"+(a?a+" is="+s:s)+">%c "+r,"color:#3a8ab0;font-weight:600;","color:#888888;font-weight:400;"),window.customElements.define(s,c,a&&{extends:a}),a&&!ut){let i=document.createElement("div");if(i.style.position="fixed",i.style.left="-1000px",i.style.top="-1000px",i.innerHTML="<"+a+' is="'+s+'"></'+a+">",document.body.append(i),i.remove(),ut)c.polyfillByRoot=D;else{let l=function(h){let S={};Object.keys(w).forEach(q=>{h[q]!==void 0&&(S[q]=h[q])}),Ct(h,w);let F=t.mode||t.shadow?Lt(h,t):void 0,xt=ot(c,h,F);t.construct&&t.construct.call(h,F,xt),Object.assign(h,S);let Yt=-1,Q;for(;Q=m[++Yt];){let q=h.attributes[Q];q&&n[Q].attribute.call(h,q.value)}t.connect&&t.connect.call(h,F,xt)},y=function(h){Ut(h,s).forEach(l),new MutationObserver(()=>Ut(h,s).forEach(l)).observe(h,{childList:!0,subtree:!0})};c.polyfillByRoot=y,y(document)}}else c.polyfillByRoot=D;return c}var H=e=>typeof e;var he=Object.defineProperties,Ft=E(H,{function:e=>e(),object:e=>e.stop()}),k=class extends B{#t;stop(){if(this.status==="done")return this;this.status="done";let t=this.#t;return this.#t=void 0,t&&t.forEach(Ft),this}done(t){return this.status==="done"?(Ft(listener),this):((this.#t||(this.#t=[])).push(t),this)}};he(k.prototype,{status:{writable:!0}});function fe(e){throw new TypeError("Stream cannot be created .from() "+typeof e)}function d(e,t){if(t===void 0)return;let n=-1;for(;e[++n];)e[n].push(t);return e}function pe(e){k.prototype.stop.apply(e);let t=-1,n;for(;n=e[++t];)e[t]=void 0,n.stop&&(gt(n,e),n[-1]||n.stop());return e}function gt(e,t){let n=0;for(;e[--n]&&e[n]!==t;);for(;e[n--];)e[n+1]=e[n]}function Gt(e,t){let n=-1;for(;e[++n]&&e[n]!==t;);for(;e[n++];)e[n-1]=e[n]}function de(e,t){gt(t,e),Gt(e,t)}var U=class extends k{stop(){if(this.status==="done")return this;let t;for(;t=this[-1];){let n=-1;for(;this[n--];)this[n+1]=this[n];Gt(t,this),t.stop&&!t[0]&&t.stop(t)}return super.stop()}},X=class extends U{constructor(t){super(),this.push=t}},z=class extends U{constructor(t,n){super(),this.fn=t,this.value=n,this.i=0}push(t){let n=this.fn;this.value=n(this.value,t,this.i++,this)}},p=class extends U{start(){if(this.status)return this;let t=0,n;t:for(;n=this[--t];){let r=-1;for(;n[++r];)if(n[r]===this)continue t;n[r]=this,r===0&&n.start&&n.start()}return this}stop(){if(this.status==="done")return this;super.stop();let t=-1,n;for(;n=this[++t];)this[t]=void 0,n.stop&&(gt(n,this),n[-1]||n.stop());return this}pipe(t){if(t.stop){let r=0;for(;t[--r]&&t[r]!==this;);t[r]=this}if(t.start&&!(t[0]||t.status==="running"))return t;let n=-1;for(;this[++n]&&this[n]!==t;);return this[n]=t,n||this.start(),t}each(t){return this.pipe(new X(t))}buffer(...t){return this.pipe(new R(t))}filter(t){return this.pipe(new ht(t))}flatMap(t){return this.pipe(new ft(t))}map(t){return this.pipe(new V(t))}reduce(t,n){return this.pipe(new z(t,n)).value}scan(t,n){return this.pipe(new dt(t,n))}slice(t,n){return this.pipe(new mt(t,n))}split(t){return this.pipe(new wt(t))}[Symbol.asyncIterator]=async function*(){let t=[],n=s=>t.push(s);function r(s,a){n=s}for(this.each(s=>n(s)).done(()=>n=D);n!==D;)yield t.length?t.shift():await new Promise(r)};static from=E(H,{function:t=>new V(t),object:t=>typeof t.pipe=="function"?t:typeof t.then=="function"?new lt(t):typeof t.length=="number"?new R(Array.from(t)):fe(t)});static of(...t){return t.length<2?new J(t[0]):new R(t)}static buffer(t){return new R(t)}static value(t){return new J(t)}static merge(...t){return new pt(t)}static push=d;static stop=pe;static unpipe=de;static each(t){return new X(t)}static reduce(t,n){return new z(t,n)}},lt=class extends p{constructor(t){super(),this.promise=t}start(){return this.promise.then(t=>d(this,t)).finally(()=>this.stop()),this}},J=class extends p{constructor(t){super(),this.value=t}start(){return this.value!==void 0&&(d(this,this.value),this.status==="done")?this:super.start()}push(t){return this.value=t,d(this,t)}},R=class extends p{constructor(t){super(),this.values=t||[]}start(){let t=this.values;if(!t)return super.start();let n=-1;for(;n++<t.length;)if(d(this,t[n]),this.status==="done")return this;return this.values=void 0,super.start()}push(t){return this.value=t,this.values?this.values.push(this.value):d(this,this.value)}},ht=class extends p{constructor(t){super(),this.fn=t}push(t){let n=this.fn;return n(t)&&d(this,t)}},ft=class extends p{constructor(t){super(),this.fn=t}push(t){let n=this.fn,r=n(t);if(r!==void 0)if(isIterable(r))for(let s of r)d(this,s);else r.pipe?(console.warn("FlatMapping pipeables is dodgy. Map to arrays for the moment please."),this.done(r.each(s=>d(this,s)))):r.then&&r.then(s=>d(this,s))}},V=class extends p{constructor(t){super(),this.fn=t}push(t){let n=this.fn,r=n(t);return r!==void 0&&d(this,r)}},pt=class extends p{constructor(t){super(),this.inputs=t}push(t){return d(this,t)}pipe(t){let n=-1,r;for(;r=this.inputs[++n];)p.from(r).pipe(this);return p.prototype.pipe.call(this,t)}},dt=class extends p{constructor(t,n){super(),this.fn=t,this.value=n}push(t){let n=this.fn;this.value=n(this.value,t),d(this,this.value)}},mt=class extends p{constructor(t,n=1/0){super(),this.index=-t,this.indexEnd=n-t}push(t){++this.index>0&&d(this,t),this.index===this.indexEnd&&this.stop()}},wt=class extends p{constructor(t){super(),this.chunk=[],typeof t=="number"?this.n=t:this.fn=t}fn(){return this.chunk.length===this.n}push(t){let n=this.chunk;this.fn(t)?(d(this,n),this.chunk=[]):n.push(t)}};var mn={fullscreenchange:Et(()=>"fullscreenElement"in document?"fullscreenchange":"webkitFullscreenElement"in document?"webkitfullscreenchange":"mozFullScreenElement"in document?"mozfullscreenchange":"msFullscreenElement"in document?"MSFullscreenChange":"fullscreenchange")},me=0;window.addEventListener("click",e=>me=e.timeStamp);function vt(e){var t={};return function(r){return r in t?t[r]:t[r]=e(r)}}function W(e){return function(n,...r){var s=e[n]||e.default;return s&&s.apply(this,r)}}var we={xml:"application/xml",html:"text/html",svg:"image/svg+xml"};function bt(e,t){if(t){var n=we[e.toLowerCase()]||e,r;try{r=new window.DOMParser().parseFromString(t,n)}catch{return}if(!r||r.getElementsByTagName("parsererror").length)throw new Error("Invalid "+e.toUpperCase()+": "+t);return r}}function Mt(e){return bt("html",e)}function It(e){return bt("svg",e)}var x=Object.assign,C={headers:function(e){return{}},body:B},ge=W({"application/x-www-form-urlencoded":function(e){return x(e,{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"})},"application/json":function(e){return x(e,{"Content-Type":"application/json; charset=utf-8","X-Requested-With":"XMLHttpRequest"})},"multipart/form-data":function(e){return x(e,{"Content-Type":"multipart/form-data","X-Requested-With":"XMLHttpRequest"})},"audio/wav":function(e){return x(e,{"Content-Type":"audio/wav","X-Requested-With":"XMLHttpRequest"})},"image/png":function(e){return x(e,{"Content-Type":"image/png","X-Requested-With":"XMLHttpRequest"})},"image/jpg":function(e){return x(e,{"Content-Type":"image/jpg","X-Requested-With":"XMLHttpRequest"})},"image/jpeg":function(e){return x(e,{"Content-Type":"image/jpeg","X-Requested-With":"XMLHttpRequest"})},default:function(e){return x(e,{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"})}}),ve=W({"application/json":function(e){return e instanceof FormData?be(e):JSON.stringify(e)},"application/x-www-form-urlencoded":function(e){return e instanceof FormData?Nt(e):Ht(e)},"multipart/form-data":function(e){return e instanceof FormData?e:ye(e)},default:B});function be(e){return JSON.stringify(Array.from(e.entries()).reduce(function(t,n){return t[n[0]]=n[1],t},{}))}function Nt(e){return new URLSearchParams(e).toString()}function Ht(e){return Object.keys(e).reduce((t,n)=>(t.append(n,e[n]),t),new URLSearchParams)}function ye(e){throw new Error("TODO: dataToFormData(data)")}function xe(e,t){return t instanceof FormData?e+"?"+Nt(t):e+"?"+Ht(t)}function Ee(e,t,n,r){let s=typeof n=="string"?n:n&&n["Content-Type"]||"application/json",a=ge(s,x(C.headers&&t?C.headers(t):{},typeof n=="string"?{}:n)),v={method:e,mode:"cors",headers:a,credentials:"same-origin",signal:r&&r.signal};return e!=="GET"&&(v.body=ve(s,C.body?C.body(t):t)),v}function $(e){return e.blob()}function Te(e){return e.json().catch(t=>{throw new Error("Cannot parse JSON "+e.url+". "+t.message)})}function Pt(e){return e.formData()}function Se(e){return e.text()}function qe(e){return e.text().then(t=>/^\s*<!DOCTYPE html>/.test(t)?Mt(t):T("fragment",t))}function Ae(e){return e.text().then(t=>/^\s*<\?xml/.test(t)?It(t):(console.warn("Untested SVG fragment parsing in request.js!"),T("fragment",t)))}var ke={"text/plain":Se,"text/html":qe,"image/svg+xml":Ae,"application/json":Te,"multipart/form-data":Pt,"application/x-www-form-urlencoded":Pt,audio:$,"audio/wav":$,"audio/m4a":$,"application/zip":$};function je(e){if(C.onresponse&&(e=C.onresponse(e)),!e.ok)throw new Error(e.statusText+"");let t=e.headers.get("Content-Type");if(!t)return;let n=t.replace(/\;.*$/,"");return ke[n](e)}function Xt(e="GET",t,n={},r="application/json"){e=e.toUpperCase(),e==="GET"&&n&&(t=xe(t,n));let s=Ee(e,n,r,arguments[4]);return fetch(t,s).then(je)}function zt(e){return Xt("GET",e)}var De={chord:3,note:3,key:1,meter:2,rate:1,lyric:2},Oe=/^[ABCDEFG][b♭#♯]{0,1}-?\d$/,Jt=/^[ABCDEFG][b♭#♯]{0,1}/;function yt(e){let t=e.trim().split(/\s+/),n=[],r=-1;for(;t[++r]!==void 0;){let s=Number(t[r]),a=t[++r];Oe.test(a)?(a="note",--r):Jt.test(a)&&(a="chord",--r);let v=[s,a],m=De[a];if(m===void 0)throw new TypeError('Unrecognised type "'+a+'" in sequence data');if(a==="chord"){let w=Jt.exec(t[++r])[0],b=t[r].slice(w.length)||t[++r],g=Number(t[++r]);v.push(w,b,g)}else for(;m--;){let w=Number(t[++r]);v.push(Number.isNaN(w)?t[r]:w)}n.push(v)}return n}function Re(e){let t=e.files[Object.keys(e.files)[0]];return j(t.type,t.content)}function Ce(e){let t=e.settings.find(matches({id:13324}))||e.settings[0];return j("abc",t.abc)}function j(e,t){if(typeof t=="object")return t.files?Re(t):t.settings?Ce():Array.isArray(t)?{id:0,events:t}:t;if(e==="sequence"||e==="text/plain")return{events:yt(t)};{let n=JSON.parse(t);return Array.isArray(n)?{id:0,events:n}:n}}var Be=vt(zt);var Vt=E((e,t)=>typeof t,{string:function(e,t){return Be(t).then(n=>j(e,n)).catch(n=>console.error(n))},default:function(e,t,n,r){t[e]=r}});var Le=/^(\d+)\/(\d+)$/;function Wt(e){let t=Le.exec(e),n=parseInt(t[1],10),r=4/parseInt(t[2],10);return{1:"meter",2:n*r,3:r}}function $t(e){let t=e[2],n=e[3],r=t/n,s=4/n;return r+"/"+s}var Kt=Object.assign,Ue=Object.defineProperties,Fe=new URL("shadow.css",import.meta.url),K=u.of(),Ge=[],Qt=new ResizeObserver(e=>{for(let t of e)o(t.target).shadowRoot.querySelectorAll(".beam").forEach(Y)}),Yn=Ue(ct("scribe-music",{shadow:`
        <link rel="stylesheet" href="${Fe}" />
    `,construct:function(e,t){let n=e.querySelector("link");Ge.push(r=>n.href=r),K.value&&(n.href=K.value),t.data=u.of(),t.clef=u.of("treble"),t.key=u.of("C"),t.meter=u.of(),t.beat=u.of(0),t.duration=u.of(1/0),t.transpose=u.of(0),t.excludes=u.of([]),t.swingAsStraight8ths=u.of(!1),t.swingAsStraight16ths=u.of(!1),t.debug=u.of(!1),t.isSafari=navigator.userAgent.includes("AppleWebKit/")&&!navigator.userAgent.includes("Chrome/")&&!navigator.userAgent.includes("Edge/")&&!navigator.userAgent.includes("Gecko/")},connect:function(e,t){if(t.isSafari&&this.classList.add("safari"),Qt.observe(this,{box:"content-box"}),!this.src){let n=this.textContent.trim();t.data.value=j(this.type,n)}return u.frame(()=>{let n=t.data.value&&qt(t.data.value,t.excludes.value,t.clef.value,t.key.value,t.meter.value,t.duration.value,t.transpose.value,t.beat.value,Kt({},St,{swingAsStraight8ths:t.swingAsStraight8ths.value,swingAsStraight16ths:t.swingAsStraight16ths.value}));if(e.querySelectorAll(".side, .bar, style").forEach(m=>m.remove()),e.append.apply(e,n),!n)return;let s=e.getElementById("side").children[0].querySelectorAll(".acci"),a=parseFloat(getComputedStyle(this).fontSize),v=T("style",":host { --signature-width: "+(2.25+s.length*.8125).toFixed(4)+"em; }");e.appendChild(v),e.querySelectorAll(".beam").forEach(Y),t.debug.value&&e.querySelectorAll(".bar").forEach(m=>{let w=parseFloat(m.dataset.duration),b=0,g,c;m.querySelector(".barrepeat")||(m.querySelectorAll(".rest[data-duration], .note[data-duration]").forEach(i=>{g!==parseFloat(i.dataset.beat)&&(g=parseFloat(i.dataset.beat),c=parseFloat(i.dataset.duration),b+=c)}),Math.round(b/.0625)!==Math.round(w/.0625)&&m.classList.add("error"))})})},disconnect:function(){Qt.unobserve(this)}},{clef:{attribute:function(e){this.clef=e},get:function(){return o(this).clef.value},set:function(e){if(!Tt[e]){console.warn('<scribe-music> Attempt to set invalid clef="'+e+'" ignored');return}o(this).clef.value=e}},key:{attribute:function(e){this.key=e===""?"C":e},get:function(){return o(this).key.value},set:function(e){let t=o(this);if(typeof e!="string"||!/^[A-G][#b♯♭]?$/.test(e)){console.warn('<scribe-music> Attempt to set invalid key="'+e+'" ignored');return}t.key.value=e.replace(/[#b]$/,n=>n==="#"?"♯":"♭")}},meter:{attribute:function(e){this.meter=e===""?"4/4":e},get:function(){return $t(o(this).meter.value)},set:function(e){o(this).meter.value=Kt([0],Wt(e))}},beat:{attribute:function(e){this.beat=e},get:function(){return o(this).beat.value},set:function(e){o(this).beat.value=typeof e=="number"?e:parseFloat(e)}},duration:{attribute:function(e){this.duration=e},get:function(){return o(this).duration.value},set:function(e){o(this).duration.value=typeof e=="number"?e:parseFloat(e)}},transpose:{attribute:function(e){this.transpose=e},get:function(){return o(this).transpose.value},set:function(e){o(this).transpose.value=typeof e=="number"?Math.round(e):parseInt(e,10)}},type:{attribute:function(e){this.type=e},writable:!0,value:"application/json"},src:{attribute:function(e){this.src=e},get:function(){return o(this).src},set:function(e){let t=o(this);t.src=e;let n=new URL(e,window.location);if(window.location.origin===n.origin&&window.location.pathname===n.pathname){let r=this.getRootNode().getElementById(n.hash.slice(1));if(!r)throw new Error('<scribe-music> src script "'+e+'" not found in document');this.data=JSON.parse(r.textContent)}else Vt(this.type,n.href).then(r=>this.data=r)},default:null},data:{get:function(){return o(this).data.value},set:function(e){o(this).data.value=e},default:null},swing:{attribute:function(e){o(this).swingAsStraight8ths.value=e!==null}},shuffle:{attribute:function(e){o(this).swingAsStraight16ths.value=e!==null}},debug:{attribute:function(e){this.debug=e!==null},get:function(){return o(this).debug.value},set:function(e){o(this).debug.value=!!e}},excludes:{attribute:function(e){return o(this).excludes.value=e.split(/\s+/)}}},null,"github.com/stephband/scribe/"),{stylesheet:{set:e=>K.value=e,get:()=>K.value}});export{Yn as default};
//# sourceMappingURL=element.js.map
